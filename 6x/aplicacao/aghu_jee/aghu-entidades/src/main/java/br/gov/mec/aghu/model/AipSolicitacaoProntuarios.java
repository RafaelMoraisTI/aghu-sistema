package br.gov.mec.aghu.model;

// Generated 10/03/2010 12:51:59 by Hibernate Tools 3.2.5.Beta

import java.util.Date;
import java.util.HashSet;
import java.util.Set;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.JoinTable;
import javax.persistence.ManyToMany;
import javax.persistence.ManyToOne;
import javax.persistence.PrePersist;
import javax.persistence.PreUpdate;
import javax.persistence.SequenceGenerator;
import javax.persistence.Table;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;
import javax.persistence.Version;


import org.hibernate.validator.constraints.Length;

import br.gov.mec.aghu.core.exception.BaseRuntimeException;
import br.gov.mec.aghu.core.exception.BusinessExceptionCode;
import br.gov.mec.aghu.core.persistence.BaseEntityCodigo;

/**
 * AipSolicitacaoProntuarios generated by hbm2java
 */
@Entity
@Table(name = "AIP_SOLICITACAO_PRONTUARIOS", schema = "AGH")
@SequenceGenerator(name = "aipSlpSeq", sequenceName = "AGH.AIP_SLP_SQ1", allocationSize = 1)

public class AipSolicitacaoProntuarios extends BaseEntityCodigo<Integer> implements java.io.Serializable {

	/**
	 * 
	 */
	private static final long serialVersionUID = 3044602425255632886L;
	private Integer codigo;
	private String solicitante;
	private Date dtSolicitacao;
	private String observacao;
	private String responsavel;
	private AghEspecialidades aghEspecialidades;
	private Date dtPrevisao;
	private Date dtConclusao;
	private AipFinalidadesMovimentacao aipFinalidadesMovimentacao;
	private AipSolicitantesProntuario aipSolicitantesProntuario;
	private Integer version;

	private Set<AipPacientes> aipPacientes = new HashSet<AipPacientes>(0);

	private enum SolicitacaoProntuariosExceptionCode implements
			BusinessExceptionCode {
		CONCLUSAO_ANTERIOR_PREVISAO, RESPONSAVEL_ESPECIALIDADE
	}

	public AipSolicitacaoProntuarios() {
	}

	public AipSolicitacaoProntuarios(Integer codigo, String solicitante,
			Date dtSolicitacao) {
		this.codigo = codigo;
		this.solicitante = solicitante;
		this.dtSolicitacao = dtSolicitacao;
	}

	public AipSolicitacaoProntuarios(Integer codigo, String solicitante,
			Date dtSolicitacao, String observacao, String responsavel,
			AghEspecialidades aghEspecialidades, Date dtPrevisao,
			Date dtConclusao,
			AipFinalidadesMovimentacao aipFinalidadesMovimentacao,
			AipSolicitantesProntuario aipSolicitantesProntuario) {
		this.codigo = codigo;
		this.solicitante = solicitante;
		this.dtSolicitacao = dtSolicitacao;
		this.observacao = observacao;
		this.responsavel = responsavel;
		this.aghEspecialidades = aghEspecialidades;
		this.dtPrevisao = dtPrevisao;
		this.dtConclusao = dtConclusao;
		this.aipFinalidadesMovimentacao = aipFinalidadesMovimentacao;
		this.aipSolicitantesProntuario = aipSolicitantesProntuario;
	}

	@Id
	@Column(name = "CODIGO", nullable = false, precision = 22, scale = 0)
	@GeneratedValue(strategy = GenerationType.AUTO, generator = "aipSlpSeq")
	public Integer getCodigo() {
		return this.codigo;
	}

	public void setCodigo(Integer codigo) {
		this.codigo = codigo;
	}

	@Column(name = "SOLICITANTE", nullable = false, length = 50)
	@Length(max = 50)
	public String getSolicitante() {
		return this.solicitante;
	}

	public void setSolicitante(String solicitante) {
		this.solicitante = solicitante;
	}

	@Temporal(TemporalType.DATE)
	@Column(name = "DT_SOLICITACAO", nullable = false, length = 7)
	public Date getDtSolicitacao() {
		return this.dtSolicitacao;
	}

	public void setDtSolicitacao(Date dtSolicitacao) {
		this.dtSolicitacao = dtSolicitacao;
	}

	@Column(name = "OBSERVACAO", length = 60)
	@Length(max = 60)
	public String getObservacao() {
		return this.observacao;
	}

	public void setObservacao(String observacao) {
		this.observacao = observacao;
	}

	@Column(name = "RESPONSAVEL", length = 50)
	@Length(max = 50)
	public String getResponsavel() {
		return this.responsavel;
	}

	public void setResponsavel(String responsavel) {
		this.responsavel = responsavel;
	}

	@ManyToOne(fetch = FetchType.LAZY)
	@JoinColumn(name = "ESP_SEQ")
	public AghEspecialidades getAghEspecialidades() {
		return this.aghEspecialidades;
	}

	public void setAghEspecialidades(AghEspecialidades aghEspecialidades) {
		this.aghEspecialidades = aghEspecialidades;
	}

	@Temporal(TemporalType.DATE)
	@Column(name = "DT_PREVISAO", length = 7)
	public Date getDtPrevisao() {
		return this.dtPrevisao;
	}

	public void setDtPrevisao(Date dtPrevisao) {
		this.dtPrevisao = dtPrevisao;
	}

	@Temporal(TemporalType.DATE)
	@Column(name = "DT_CONCLUSAO", length = 7)
	public Date getDtConclusao() {
		return this.dtConclusao;
	}

	public void setDtConclusao(Date dtConclusao) {
		this.dtConclusao = dtConclusao;
	}

	@ManyToOne(fetch = FetchType.LAZY)
	@JoinColumn(name = "FMV_SEQ")
	public AipFinalidadesMovimentacao getAipFinalidadesMovimentacao() {
		return this.aipFinalidadesMovimentacao;
	}

	public void setAipFinalidadesMovimentacao(
			AipFinalidadesMovimentacao aipFinalidadesMovimentacao) {
		this.aipFinalidadesMovimentacao = aipFinalidadesMovimentacao;
	}

	@ManyToOne(fetch = FetchType.LAZY)
	@JoinColumn(name = "SOP_SEQ")
	public AipSolicitantesProntuario getAipSolicitantesProntuario() {
		return this.aipSolicitantesProntuario;
	}

	public void setAipSolicitantesProntuario(
			AipSolicitantesProntuario aipSolicitantesProntuario) {
		this.aipSolicitantesProntuario = aipSolicitantesProntuario;
	}

	@ManyToMany(fetch = FetchType.LAZY)
	@JoinTable(name = "AIP_PACIENTES_SOLICITACAO_PRON", schema = "AGH", joinColumns = { @JoinColumn(name = "SLP_CODIGO", nullable = false, updatable = false) }, inverseJoinColumns = { @JoinColumn(name = "PAC_CODIGO", nullable = false, updatable = false) })
	public Set<AipPacientes> getAipPacientes() {
		return this.aipPacientes;
	}

	public void setAipPacientes(Set<AipPacientes> aipPacientes) {
		this.aipPacientes = aipPacientes;
	}

	@Version
	@Column(name = "VERSION", nullable = false)
	public Integer getVersion() {
		return version;
	}

	public void setVersion(Integer version) {
		this.version = version;
	}

	

	public enum Fields {
		CODIGO("codigo"), SOLICITANTE("solicitante"), DT_SOLICITACAO(
				"dtSolicitacao"), OBSERVACAO("observacao"), RESPONSAVEL(
				"responsavel"), DT_PREVISAO("dtPrevisao"), DT_CONCLUSAO(
				"dtConclusao"), SOLICITANTE_PRONTUARIO(
				"aipSolicitantesProntuario"), SOLICITANTE_PRONTUARIO_SEQ(
				"aipSolicitantesProntuario.seq"), FINALIDADE_MOVIMENTACAO(
				"aipFinalidadesMovimentacao"), FINALIDADE_MOVIMENTACAO_CODIGO(
				"aipFinalidadesMovimentacao.codigo"), ESPECIALIDADE(
				"aghEspecialidades"), ESPECIALIDADE_SEQ("aghEspecialidades.seq"), PACIENTES("aipPacientes");

		private String fields;

		private Fields(String fields) {
			this.fields = fields;
		}

		@Override
		public String toString() {
			return fields;
		}
	}

	@SuppressWarnings("unused")
	@PrePersist
	@PreUpdate
	private void validar() {

		// ORADB constrain AIP_SLP_CK2
		if (this.dtConclusao != null
				&& this.dtConclusao.before(this.dtPrevisao)) {
			throw new BaseRuntimeException(
					SolicitacaoProntuariosExceptionCode.CONCLUSAO_ANTERIOR_PREVISAO);
		}

		if(!((this.responsavel == null && this.aghEspecialidades == null) || (this.responsavel != null && this.aghEspecialidades != null) || (this.responsavel != null && this.aghEspecialidades == null))) {
			throw new BaseRuntimeException(
					SolicitacaoProntuariosExceptionCode.RESPONSAVEL_ESPECIALIDADE);
		}

		if (this.getAghEspecialidades() != null && this.responsavel == null
				&& this.dtConclusao.before(this.dtPrevisao)) {
			throw new BaseRuntimeException(
					SolicitacaoProntuariosExceptionCode.RESPONSAVEL_ESPECIALIDADE);

		}

	}

	@Override
	public int hashCode() {
		final int prime = 31;
		int result = 1;
		result = prime * result + ((codigo == null) ? 0 : codigo.hashCode());
		return result;
	}

	@Override
	public boolean equals(Object obj) {
		if (this == obj) {
			return true;
		}
		if (obj == null) {
			return false;
		}
		if (getClass() != obj.getClass()) {
			return false;
		}
		AipSolicitacaoProntuarios other = (AipSolicitacaoProntuarios) obj;
		if (codigo == null) {
			if (other.codigo != null) {
				return false;
			}
		} else if (!codigo.equals(other.codigo)) {
			return false;
		}
		return true;
	}

}
