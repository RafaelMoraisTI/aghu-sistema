<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions" xmlns:mec="http://xmlns.jcp.org/jsf/composite/components" xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:aghu="http://xmlns.jcp.org/jsf/component" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:mf="http://www.mec.gov.br/taglib">  
  <ui:composition template="/WEB-INF/templates/form_template.xhtml"> 
    <ui:define name="head"> 
      <title>#{messages.LABEL_SOLICITACAO_DIVERSOS_CONSULTA_SOLICITACAO_DIVERSOS}</title> 
    </ui:define>  
    <ui:define name="metadata"> 
      <f:metadata> 
        <f:viewAction action="#{pesquisaSolicitacaoDiversosController.inicio}"/> 
      </f:metadata> 
    </ui:define>  
    <ui:define name="body"> 
      <mec:pageConfig controller="#{pesquisaSolicitacaoDiversosController}"/>  
      <h:form prependId="false" id="formDadosBasicosExames"> 
        <pe:remoteCommand name="selecionar"> 
          <pe:assignableParam name="param" assignTo="#{pesquisaSolicitacaoDiversosController.seqSelecionado}"/> 
        </pe:remoteCommand>  
        <aghu:panelGeral legend="#{messages.LABEL_SOLICITACAO_DIVERSOS_ATENDIMENTOS_DIVERSOS}"> 
          <aghu:linha> 
            <mec:suggestionBox id="suggestionProjetoPesquisa" label="#{messages.LABEL_SOLICITACAO_DIVERSOS_PROJETO_PESQUISA}" title="#{messages.TITLE_SOLICITACAO_DIVERSOS_PROJETO_PESQUISA}" descricaoInput="numero" descricaoLabel="nome" suggestionAction="obterProjetosPesquisa" required="false" posSelectionAction="desabilitarSuggestions" posDeleteAction="habilitarSuggestions" readonly="#{pesquisaSolicitacaoDiversosController.desabilitaProjetoPesquisa}" width="900" controller="#{pesquisaSolicitacaoDiversosController}" value="#{pesquisaSolicitacaoDiversosController.projetoPesquisa}" render="suggestionLaboratorioExterno,suggestionControleQualidade,suggestionCadaver,suggestionDoador"> 
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_CODIGO}</b> 
                </f:facet> #{item.seq}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_NUMERO}</b> 
                </f:facet> #{item.numero}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_PROJETO_PESQUISA}</b> 
                </f:facet> #{item.nome}
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:suggestionBox id="suggestionLaboratorioExterno" label="#{messages.LABEL_SOLICITACAO_DIVERSOS_LABORATORIO_EXTERNO}" title="#{messages.TITLE_SOLICITACAO_DIVERSOS_LABORATORIO_EXTERNO}" descricaoInput="seq" descricaoLabel="nome" suggestionAction="obterLaboratoriosExternos" required="false" posSelectionAction="desabilitarSuggestions" posDeleteAction="habilitarSuggestions" readonly="#{pesquisaSolicitacaoDiversosController.desabilitaLaboratorioExterno}" width="900" controller="#{pesquisaSolicitacaoDiversosController}" value="#{pesquisaSolicitacaoDiversosController.laboratorioExterno}" render="suggestionProjetoPesquisa,suggestionControleQualidade,suggestionCadaver,suggestionDoador"> 
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_CODIGO}</b> 
                </f:facet> #{item.seq}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_LABORATORIO}</b> 
                </f:facet> #{item.nome}
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:suggestionBox id="suggestionControleQualidade" label="#{messages.LABEL_SOLICITACAO_DIVERSOS_CONTROLE_QUALIDADE}" title="#{messages.TITLE_SOLICITACAO_DIVERSOS_CONTROLE_QUALIDADE}" descricaoInput="seq" descricaoLabel="material" suggestionAction="obterControlesQualidade" required="false" posSelectionAction="desabilitarSuggestions" posDeleteAction="habilitarSuggestions" readonly="#{pesquisaSolicitacaoDiversosController.desabilitaControleQualidade}" width="900" controller="#{pesquisaSolicitacaoDiversosController}" value="#{pesquisaSolicitacaoDiversosController.controleQualidade}" render="suggestionProjetoPesquisa,suggestionLaboratorioExterno,suggestionCadaver,suggestionDoador"> 
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_CODIGO}</b> 
                </f:facet> #{item.seq}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_MATERIAL}</b> 
                </f:facet> #{item.material}
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:suggestionBox id="suggestionCadaver" label="#{messages.LABEL_SOLICITACAO_DIVERSOS_CADAVER}" title="#{messages.TITLE_SOLICITACAO_DIVERSOS_CADAVER}" descricaoInput="seq" descricaoLabel="nome" suggestionAction="obterCadaveres" required="false" posSelectionAction="desabilitarSuggestions" posDeleteAction="habilitarSuggestions" readonly="#{pesquisaSolicitacaoDiversosController.desabilitaCadaver}" width="900" controller="#{pesquisaSolicitacaoDiversosController}" value="#{pesquisaSolicitacaoDiversosController.cadaver}" render="suggestionProjetoPesquisa,suggestionLaboratorioExterno,suggestionControleQualidade,suggestionDoador"> 
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_CODIGO}</b> 
                </f:facet> #{item.seq}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_NOME}</b> 
                </f:facet> #{item.nome}
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:suggestionBox id="suggestionDoador" label="#{messages.LABEL_SOLICITACAO_DIVERSOS_DOADOR}" title="#{messages.TITLE_SOLICITACAO_DIVERSOS_DOADOR}" descricaoInput="seq" descricaoLabel="nome" suggestionAction="obterDoadores" required="false" posSelectionAction="desabilitarSuggestions" posDeleteAction="habilitarSuggestions" readonly="#{pesquisaSolicitacaoDiversosController.desabilitaDoador}" width="900" controller="#{pesquisaSolicitacaoDiversosController}" value="#{pesquisaSolicitacaoDiversosController.doador}" render="suggestionProjetoPesquisa,suggestionLaboratorioExterno,suggestionControleQualidade,suggestionCadaver"> 
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_CODIGO}</b> 
                </f:facet> #{item.seq}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_PACIENTE}</b> 
                </f:facet> #{item.nome}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_DT_NASCIMENTO}</b> 
                </f:facet>  
                <h:outputText value="#{item.dtNascimento}"> 
                  <f:convertDateTime pattern="dd/MM/yyyy"/> 
                </h:outputText> 
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha> 
        </aghu:panelGeral>  
        <aghu:panelGeral legend="#{messages.LABEL_SOLICITACAO_DIVERSOS_INFORMACAO_COMPLEMENTAR}"> 
          <aghu:linha> 
            <p:outputPanel id="pacienteDecorate" layout="inline">
             
              <mec:pesquisaPaciente 
              		id="pesqPaciente" 
              		valueChangeListener="#{pesquisaSolicitacaoDiversosController.pesquisaPaciente}" 
              		value="#{pesquisaSolicitacaoDiversosController.paciente}" 
              		render="valorDataInicio, valorDataFim"/>  
              <br clear="none"/>  
              <mec:commandButton 
              			value="#{messages.LABEL_PESQUISA_FONETICA}" 
              			immediate="true" 
              			action="#{pesquisaSolicitacaoDiversosController.redirecionarPesquisaFonetica}" 
              			styleClass=" bt_cinza icon-pesquisa-fonetica"> 
                <f:setPropertyActionListener target="#{pesquisaPacienteController.cameFrom}" value="exames-pesquisarSolicitacaoDiversos" for="command"/>  
                <f:setPropertyActionListener target="#{pesquisaPacienteController.exibeBotaoEditar}" value="false" for="command"/>  
                <f:setPropertyActionListener target="#{pesquisaPacienteController.paramExibeBotaoIncluir}" value="false" for="command"/> 
              </mec:commandButton> 
            </p:outputPanel>
             
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputNumero id="solicitacao" label="#{messages.LABEL_SOLICITACAO_DIVERSOS_SOLICITACAO}" title="#{messages.TITLE_SOLICITACAO_DIVERSOS_SOLICITACAO}" value="#{pesquisaSolicitacaoDiversosController.solicitacao}" size="6"> 
              <p:ajax event="change" update="@(#valorDataInicio) @(#valorDataFim)" process="@this"/> 
            </mec:inputNumero>  
            <mec:suggestionBox id="suggestionExame" label="#{messages.LABEL_EXAME_PATOLOGIA_CIRURGICA}" title="#{messages.TITLE_EXAME_PATOLOGIA_CIRURGICA}" suggestionAction="pesquisarAelConfigExLaudoUnico" width="500" descricaoInput="sigla" descricaoLabel="nome" maxlength="200" controller="#{pesquisaSolicitacaoDiversosController}" value="#{pesquisaSolicitacaoDiversosController.configExLaudoUnico}"> 
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SIGLA}</b> 
                </f:facet> #{item.sigla}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_NOME}</b> 
                </f:facet> #{item.nome}
              </p:column> 
            </mec:suggestionBox>  
            <mec:inputText id="numeroAp" label="#{messages.LABEL_SOLICITACAO_DIVERSOS_NUMERO_EXAME}" title="#{messages.TITLE_SOLICITACAO_DIVERSOS_NUMERO_EXAME}" value="#{pesquisaSolicitacaoDiversosController.numeroAp}" styleClass="mask_(999999/99)" size="10" maxlength="9" converter="#{numeroApConverter}"> 
              <p:ajax event="change" update="@(#valorDataInicio) @(#valorDataFim)" process="@this"/> 
            </mec:inputText>  
            <mec:suggestionBox id="suggestionSituacaoId" label="#{messages.LABEL_SOLICITACAO_DIVERSOS_SITUACAO}" title="#{messages.TITLE_SOLICITACAO_DIVERSOS_SITUACAO}" descricaoInput="codigo" descricaoLabel="descricao" suggestionAction="obterSituacoes" required="false" width="900" controller="#{pesquisaSolicitacaoDiversosController}" value="#{pesquisaSolicitacaoDiversosController.situacao}"> 
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_SOLICITACAO_DIVERSOS_CODIGO}</b> 
                </f:facet> #{item.codigo}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_DESCRICAO}</b> 
                </f:facet> #{item.descricao}
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:selectOneMenu id="mostraExamesCancelados" label="#{messages.LABEL_SOLICITACAO_DIVERSOS_MOSTRA_EXAMES_CANCELADOS}" title="#{messages.TITLE_SOLICITACAO_DIVERSOS_MOSTRA_EXAMES_CANCELADOS}" noSelectionOption="false" ajaxValidation="false" value="#{pesquisaSolicitacaoDiversosController.mostraExamesCancelados}" enum="DominioSimNao"/>  
            <mec:selectOneMenu id="somenteLaboratorial" label="#{messages.LABEL_SOLICITACAO_DIVERSOS_SOMENTE_LABORATORIAL}" title="#{messages.TITLE_SOLICITACAO_DIVERSOS_SOMENTE_LABORATORIAL}" noSelectionOption="false" ajaxValidation="false" value="#{pesquisaSolicitacaoDiversosController.somenteLaboratorial}" enum="DominioSimNao"/>  
            <mec:selectOneMenu id="impressoLaudo" label="#{messages.LABEL_SOLICITACAO_DIVERSOS_IMPRESSO_LAUDO}" title="#{messages.TITLE_SOLICITACAO_DIVERSOS_IMPRESSO_LAUDO}" noSelectionOption="true" ajaxValidation="false" value="#{pesquisaSolicitacaoDiversosController.impressoLaudo}" enum="DominioSimNao"/> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputTextData label="#{messages.LABEL_LABEL_SOLICITACAO_DIVERSOS_DATA_INICIAL}" id="valorDataInicio"  title="#{messages.TITLE_LABEL_SOLICITACAO_DIVERSOS_DATA_INICIAL}" value="#{pesquisaSolicitacaoDiversosController.dtInicio}" tipo="data"/>  
            <mec:inputTextData label="#{messages.LABEL_LABEL_SOLICITACAO_DIVERSOS_DATA_FINAL}" id="valorDataFim" title="#{messages.TITLE_LABEL_SOLICITACAO_DIVERSOS_DATA_FINAL}" value="#{pesquisaSolicitacaoDiversosController.dtFinal}" tipo="data"/> 
          </aghu:linha> 
        </aghu:panelGeral>  
        <aghu:acao> 
          <mec:commandButton id="bt_pesquisar" name="bt_pesquisar" value="#{messages.LABEL_SOLICITACAO_DIVERSOS_PESQUISAR}" block="true" disabled="#{!mf:hasPermission(securityController,'pesquisarSolicitacaoDiversos,pesquisar')}" action="#{pesquisaSolicitacaoDiversosController.pesquisar}" render="panelResultados" profile="ok" defaultCommand="true"/>  
          <mec:commandButton value="#{messages.LABEL_LIMPAR}" id="bt_limpar" action="#{pesquisaSolicitacaoDiversosController.limparPesquisa}" profile="clear" ajax="true" render="formDadosBasicosExames" process="@this"/>  
          <mec:commandButton id="bt_voltar" value="#{messages.LABEL_VOLTAR}" immediate="true" rendered="#{pesquisaSolicitacaoDiversosController.voltarPara != null}" action="#{pesquisaSolicitacaoDiversosController.voltar}" styleClass=" alinha-direita bt_cinza" profile="back"/> 
        </aghu:acao>  
        <p:outputPanel id="panelMsgNaoEncontrado" layout="inline"> 
          <p:outputPanel id="msgNaoEncontrado" layout="block" styleClass="div-alerta" rendered="#{empty pesquisaSolicitacaoDiversosController.listaSolicitacaoDiversos and pesquisaSolicitacaoDiversosController.pesquisaEfetuada}"> 
            <h:outputText value="#{messages.MESSAGE_SOLICITACAO_DIVERSOS_NAO_ENCONTRADO}"/> 
          </p:outputPanel> 
        </p:outputPanel>  
        <p:outputPanel id="panelResultados" layout="inline"> 
          <p:outputPanel rendered="#{not empty pesquisaSolicitacaoDiversosController.listaSolicitacaoDiversos}" layout="inline" styleClass="aghu-panel-geral"> 
            <aghu:panelGeral> 
              <aghu:linha> 
                <table width="100%"> 
                  <tr> 
                    <td width="90%" rowspan="1" colspan="1"> 
                      <p:outputPanel layout="block" style="width: 100%; height:300px; overflow:auto;"> 
                        <mec:serverDataTable id="gridSolicitacaoDiversos" list="#{pesquisaSolicitacaoDiversosController.listaSolicitacaoDiversos}" scrollable="true"> 
                          <c:set var="_solicitacaoDiversos" value="#{item}"/>  
                          <p:column width="5%" style="text-align:center;"> 
                            <h:selectBooleanCheckbox id="marcador" value="#{_solicitacaoDiversos.verResultado}"> 
                              <p:ajax event="click" update="@(#tabelaAcao) @(#gridSolicitacaoDiversos)" process="@this" listener="#{pesquisaSolicitacaoDiversosController.selecionaItemExame(_solicitacaoDiversos.soeSeq, _solicitacaoDiversos.seqp)}"/> 
                            </h:selectBooleanCheckbox> 
                          </p:column>  
                          <p:column width="14%"> 
                            <f:facet name="header"> 
                              <h:outputText value="#{messages.LABEL_SOLICITACAO_DIVERSOS_PACIENTE_DIVERSO}"/> 
                            </f:facet>  
                            <h:outputText value="#{_solicitacaoDiversos.nomePaciente}"/> 
                          </p:column>  
                          <p:column width="40%"> 
                            <f:facet name="header"> 
                              <h:outputText value="#{messages.LABEL_SOLICITACAO_DIVERSOS_SOLICITACAO}"/> 
                            </f:facet>  
                            <h:outputText value="#{_solicitacaoDiversos.soeSeq}"/> 
                          </p:column>  
                          <p:column width="10%"> 
                            <f:facet name="header"> 
                              <h:outputText value="#{messages.LABEL_SOLICITACAO_DIVERSOS_ITEM}"/> 
                            </f:facet>  
                            <h:outputText value="#{_solicitacaoDiversos.seqp}"/> 
                          </p:column>  
                          <p:column width="14%"> 
                            <f:facet name="header"> 
                              <h:outputText value="#{messages.LABEL_SOLICITACAO_DIVERSOS_EXAME}"/> 
                            </f:facet>  
                            <h:outputText value="#{_solicitacaoDiversos.descricaoUsualExame}"/> 
                          </p:column>  
                          <p:column width="14%"> 
                            <f:facet name="header"> 
                              <h:outputText value="#{messages.LABEL_SOLICITACAO_DIVERSOS_SIT}"/> 
                            </f:facet>  
                            <h:outputText value="#{_solicitacaoDiversos.sitDescricao}"/> 
                          </p:column>  
                          <p:column width="14%"> 
                            <f:facet name="header"> 
                              <h:outputText value="#{messages.LABEL_SOLICITACAO_DIVERSOS_DATA_HORA}"/> 
                            </f:facet>  
                            <h:outputText value="#{_solicitacaoDiversos.dataHoraEvento}"> 
                              <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/> 
                            </h:outputText> 
                          </p:column>  
                          <p:column width="14%"> 
                            <f:facet name="header"> 
                              <h:outputText value="#{messages.LABEL_SOLICITACAO_DIVERSOS_ALTERADO}"/> 
                            </f:facet>  
                            <h:outputText value="#{_solicitacaoDiversos.alterado}"/> 
                          </p:column> 
                        </mec:serverDataTable> 
                      </p:outputPanel> 
                    </td>  
                    <td width="1%" rowspan="1" colspan="1"/>  
                    <td width="9%" align="center" valign="top" rowspan="1" colspan="1"> 
                      <div class="menu-direita"> 
                        <p:outputPanel id="tabelaAcao" layout="inline"> 
                          <mec:commandButton 
                          		disabled="#{empty pesquisaSolicitacaoDiversosController.solicitacoes}" 
                          		action="#{pesquisaSolicitacaoDiversosController.verResultados()}" 
                          		value="#{messages.LABEL_SOLICITACAO_DIVERSOS_VISUALIZACAO}" styleClass="bt_cinza"
								style="width: 98%"> 
                            <f:setPropertyActionListener target="#{consultarResultadosNotaAdicionalController.voltarPara}" 
                            	value="exames-pesquisarSolicitacaoDiversos" for="command"/> 
                          </mec:commandButton>  
                          <mec:commandButton value="#{messages.LABEL_SOLICITACAO_DIVERSOS_IMAGENS}" id="bt_imagens" 
                          		disabled="#{empty pesquisaSolicitacaoDiversosController.getUrlImpax()}" 
                          		rendered="#{mf:hasPermission(securityController,'verImagensExames,pesquisar')}" 
                          		onclick="window.open('#{pesquisaSolicitacaoDiversosController.getUrlImpax()}', 'IMPAX');return false" 
                          		ajax="true" styleClass="bt_cinza"
								style="width: 98%">
                          </mec:commandButton>  
                          <mec:commandButton value="#{messages.LABEL_SOLICITACAO_DIVERSOS_DETALHAR_EXAMES}" 
                          		disabled="#{empty pesquisaSolicitacaoDiversosController.solicitacoes or not mf:hasPermission(securityController,'detalharItemSolicitacao,pesquisar')}" 
                          		action="#{pesquisaSolicitacaoDiversosController.detalhesExames()}" 
                          		styleClass="bt_cinza"
								style="width: 98%" > 
                            <f:setPropertyActionListener target="#{detalharItemSolicitacaoExameController.soeSeq}" value="#{pesquisaSolicitacaoDiversosController.codigoSoeSelecionado}" for="command"/>  
                            <f:setPropertyActionListener target="#{detalharItemSolicitacaoExameController.seqp}" value="#{pesquisaSolicitacaoDiversosController.iseSeqSelecionado}" for="command"/>  
                            <f:setPropertyActionListener target="#{detalharItemSolicitacaoExameController.voltarPara}" value="exames-pesquisarSolicitacaoDiversos" for="command"/> 
                          </mec:commandButton> 
                        </p:outputPanel> 
                      </div> 
                    </td> 
                  </tr> 
                </table> 
              </aghu:linha> 
            </aghu:panelGeral> 
          </p:outputPanel> 
        </p:outputPanel> 
      </h:form> 
    </ui:define> 
  </ui:composition> 
</html>
