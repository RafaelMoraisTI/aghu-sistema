<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions" xmlns:mec="http://xmlns.jcp.org/jsf/composite/components" xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:aghu="http://xmlns.jcp.org/jsf/component" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:mf="http://www.mec.gov.br/taglib">  
  <ui:composition> 
    <p:outputPanel id="panelPacienteAba1" ajaxRendered="true" layout="inline"> 
      <h:outputText id="nomePaciente" value="#{informacaoColetaController.labelPaciente}" escape="false"/>  
      <h:outputText id="labelSolicitacao" value="#{informacaoColetaController.labelSolicitacao}" escape="false"/> 
    </p:outputPanel>  
    <aghu:panelGeral legend="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_INFORMACOES_COLETA}"> 
      <p:outputPanel id="panelFieldsInfoColeta" layout="inline"> 
        <aghu:linha> 
          <mec:selectOneMenu id="pacienteCumpriuJejum" label="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_CUMPRIU_JEJUM}" title="#{messages.TITLE_REGISTRAR_INFORMACOES_COLETA_EXAME_CUMPRIU_JEJUM}" noSelectionOption="false" value="#{informacaoColetaController.pacienteCumpriuJejum}" enum="DominioCumpriuJejumColeta"> 
            <p:ajax event="change" update="@(#motivoJejumNaoRealizado)" process="@this"/> 
          </mec:selectOneMenu>  
          <mec:inputText id="motivoJejumNaoRealizado" label="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_MOTIVO_NAO_CUMPRIU_JEJUM}" title="#{messages.TITLE_REGISTRAR_INFORMACOES_COLETA_EXAME_MOTIVO_NAO_CUMPRIU_JEJUM}" value="#{informacaoColetaController.motivoJejumNaoRealizado}" size="60" maxlength="60" readonly="#{informacaoColetaController.desabilitaPacienteCumpriuJejum}"/> 
        </aghu:linha>  
        <aghu:linha> 
          <mec:selectOneMenu id="pacienteApresentouRgComFoto" label="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_APRESENTOU_RG_COM_FOTO}" title="#{messages.TITLE_REGISTRAR_INFORMACOES_COLETA_EXAME_APRESENTOU_RG_COM_FOTO}" noSelectionOption="false" value="#{informacaoColetaController.pacienteApresentouRgComFoto}" enum="DominioSimNao"/>  
          <mec:selectOneMenu id="tipoAcessoColeta" label="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_TIPO_ACESSO_COLETA}" title="#{messages.TITLE_REGISTRAR_INFORMACOES_COLETA_EXAME_TIPO_ACESSO_COLETA}" noSelectionOption="false" value="#{informacaoColetaController.tipoAcessoColeta}" enum="DominioTipoAcessoColeta"/> 
        </aghu:linha>  
        <aghu:linha> 
          <mec:inputTextData id="dtUltimaMenstruacao" label="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_DT_ULTIMA_MENSTRUACAO}" title="#{messages.TITLE_REGISTRAR_INFORMACOES_COLETA_EXAME_DT_ULTIMA_MENSTRUACAO}" value="#{informacaoColetaController.dtUltimaMenstruacao}" readonly="#{informacaoColetaController.pacienteNaoSoubeInfoMenstruacao}" size="10" maxlength="10" tipo="data"/>  
          <h:selectBooleanCheckbox id="pacienteNaoSoubeInfoMenstruacao" title="#{messages.TITLE_REGISTRAR_INFORMACOES_COLETA_EXAME_PAC_INFO_MENSTRUACAO}" value="#{informacaoColetaController.pacienteNaoSoubeInfoMenstruacao}"> 
            <p:ajax event="change" bypassUpdates="false" update="@(#dtUltimaMenstruacao)" process="@this"/> 
          </h:selectBooleanCheckbox>  
          <h:outputText value="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_PAC_INFO_MENSTRUACAO}"/> 
        </aghu:linha>  
        <aghu:linha> 
          <mec:selectOneMenu id="localColeta" label="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_AMOSTRA_COLETADA_POR}" title="#{messages.TITLE_REGISTRAR_INFORMACOES_COLETA_EXAME_AMOSTRA_COLETADA_POR}" noSelectionOption="false" value="#{informacaoColetaController.localColeta}" enum="DominioLocalColetaAmostra"/> 
        </aghu:linha>  
        <aghu:linha> 
          <mec:inputTextArea id="informacoesAdicionais" cols="120" rows="5" label="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_INFORMACOES_ADICIONAIS}" title="#{messages.TITLE_REGISTRAR_INFORMACOES_COLETA_EXAME_INFORMACOES_ADICIONAIS}" value="#{informacaoColetaController.informacoesAdicionais}" maxlength="2000"/> 
        </aghu:linha> 
      </p:outputPanel> 
    </aghu:panelGeral>  
    <aghu:panelGeral legend="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_MEDICAMENTOS}"> 
      <aghu:linha> 
        <h:selectBooleanCheckbox id="pacienteNaoSoubeInfoMedicamento" title="#{messages.TITLE_REGISTRAR_INFORMACOES_COLETA_EXAME_PAC_INFO_MEDICAMENTO}" value="#{informacaoColetaController.pacienteNaoSoubeInfoMedicamento}"> 
          <p:ajax event="change" bypassUpdates="false" update="@(#panelFieldsMedicamento)" process="@this" listener="#{informacaoColetaController.selecionaDeselecionaPacienteNaoSoubeInformar()}"/> 
        </h:selectBooleanCheckbox>  
        <h:outputText value="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_PAC_INFO_MEDICAMENTO}"/> 
      </aghu:linha>  
      <p:outputPanel id="panelFieldsMedicamento" layout="inline"> 
        <aghu:linha> 
          <mec:inputText id="medicamento" immediate="true" label="#{messages.LABEL_MEDICAMENTO}" 
          	title="#{messages.TITLE_REGISTRAR_INFORMACOES_COLETA_EXAME_MEDICAMENTO}" value="#{informacaoColetaController.medicamento}" 
          	size="60" maxlength="60" requiredFake="true" style="text-transform:uppercase" 
          	readonly="#{informacaoColetaController.pacienteNaoSoubeInfoMedicamento}">
          	<p:ajax event="change" process="@this"/>
          </mec:inputText>  
          <mec:inputTextData id="dthrIngeriu" label="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_DATA_HORA_INGESTAO}" title="#{messages.TITLE_REGISTRAR_INFORMACOES_COLETA_EXAME_DATA_HORA_INGESTAO}" value="#{informacaoColetaController.dthrIngeriu}" size="12" maxlength="12" readonly="#{informacaoColetaController.pacienteNaoSoubeInfoMedicamento}" tipo="datahora"/>  
          <mec:inputTextData id="dthrColetou" label="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_DATA_HORA_COLETA}" title="#{messages.TITLE_REGISTRAR_INFORMACOES_COLETA_EXAME_DATA_HORA_COLETA}" value="#{informacaoColetaController.dthrColetou}" size="12" maxlength="12" requiredFake="true" tipo="datahora" readonly="#{informacaoColetaController.pacienteNaoSoubeInfoMedicamento}"/>  
          <p:outputPanel id="panelBotoesMedicamento" layout="inline"> 
            <aghu:acao newLine="false"> 
              	
              <mec:commandButton id="bt_adicionar"
			                     value="#{messages.LABEL_ADICIONAR}"
			                     action="#{informacaoColetaController.alterarInformacaoMdtoColeta}"
			                     process="@this"
			                     rendered="#{not informacaoColetaController.possuiInformacaoMdtoColetaEmEdicao and mf:hasPermission(securityController,'informacaoColetaAmostra,executar')}"
			                     profile="add"
			                     styleClass="bt_verde"
			                     ajax="true"
			                     readonly="#{informacaoColetaController.pacienteNaoSoubeInfoMedicamento}"
			                     render="panelGravarAba1, pacienteNaoSoubeInfoMedicamento, panelTabelaInformacaoMdtoColeta, panelBotoesMedicamento, medicamento, dthrIngeriu, dthrColetou"/>  
              <mec:commandButton id="bt_alterar" 
                                 value="#{messages.LABEL_ALTERAR}" 
                                 action="#{informacaoColetaController.alterarInformacaoMdtoColeta}" 
                                 process="@this @(#medicamento) @(#dthrIngeriu) @(#dthrColetou)"
                                 rendered="#{informacaoColetaController.possuiInformacaoMdtoColetaEmEdicao and mf:hasPermission(securityController,'informacaoColetaAmostra,executar')}" 
                                 profile="ok" 
                                 ajax="true" 
                                 render="pacienteNaoSoubeInfoMedicamento, panelTabelaInformacaoMdtoColeta, panelBotoesMedicamento, medicamento, dthrIngeriu, dthrColetou"/>  
              <mec:commandButton id="bt_cancelarEdic" 
                                 value="#{messages.LABEL_CANCELAR_EDICAO}" 
                                 action="#{informacaoColetaController.cancelarEdicaoInformacaoMdtoColeta}" 
                                 rendered="#{informacaoColetaController.possuiInformacaoMdtoColetaEmEdicao and mf:hasPermission(securityController,'informacaoColetaAmostra,executar')}" 
                                 profile="cancel" 
                                 ajax="true" 
                                 render="pacienteNaoSoubeInfoMedicamento, panelTabelaInformacaoMdtoColeta, panelBotoesMedicamento, medicamento, dthrIngeriu, dthrColetou"/> 
            </aghu:acao> 
          </p:outputPanel> 
        </aghu:linha> 
      </p:outputPanel>  
      <aghu:linha> 
        <p:outputPanel id="panelTabelaInformacaoMdtoColeta" rendered="#{mf:hasPermission(securityController,'informacaoColetaAmostra,pesquisar')}" layout="inline"> 
          <mec:serverDataTable id="tabelaInformacaoMdtoColeta" list="#{informacaoColetaController.listaInformacaoMdtoColeta}" scrollable="true" scrollHeight="130"> 
            <c:set var="infoMdtoColeta" value="#{item}"/>  
            <p:column style="#{infoMdtoColeta.emEdicao eq true ? 'background-color:yellow;' : ''}"> 
              <f:facet name="header"> 
                <h:outputText value="#{messages.LABEL_ACAO}"/> 
              </f:facet>  
              <mec:commandLink id="link_editar"
                               title="#{messages.LABEL_EDITAR}" 
                               action="#{informacaoColetaController.editarInformacaoMdtoColeta()}"                                 
                               rendered="#{not informacaoColetaController.possuiInformacaoMdtoColetaEmEdicao and mf:hasPermission(securityController,'informacaoColetaAmostra,executar')}"
                               profile="edit" 
                               ajax="true" 
                               render="pacienteNaoSoubeInfoMedicamento, panelTabelaInformacaoMdtoColeta, panelFieldsMedicamento" 
                               process="@this">
              		<f:setPropertyActionListener for="command" value="#{infoMdtoColeta}" target="#{informacaoColetaController.mdtoColetaEdit}"/>
			  </mec:commandLink>	                                 
              <mec:commandLink id="link_excluir"
                               title="#{messages.LABEL_EXCLUIR}" 
                               action="#{informacaoColetaController.removerInformacaoMdtoColeta()}"                                 
                               rendered="#{not informacaoColetaController.possuiInformacaoMdtoColetaEmEdicao and mf:hasPermission(securityController,'informacaoColetaAmostra,executar')}"
                               profile="delete" 
                               ajax="true" 
                               render="panelTabelaInformacaoMdtoColeta">
            		<f:setPropertyActionListener for="command" value="#{infoMdtoColeta}" target="#{informacaoColetaController.mdtoColetaEdit}"/>
              </mec:commandLink>		 
            </p:column>  
            <p:column style="#{infoMdtoColeta.emEdicao eq true ? 'background-color:yellow;' : ''}"> 
              <f:facet name="header"> 
                <h:outputText value="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_MEDICAMENTO_UTILIZADO}"/> 
              </f:facet>  
              <h:outputText value="#{infoMdtoColeta.medicamento}"/> 
            </p:column>  
            <p:column style="#{infoMdtoColeta.emEdicao eq true ? 'background-color:yellow;' : ''}"> 
              <f:facet name="header"> 
                <h:outputText value="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_DATA_HORA_INGESTAO}"/> 
              </f:facet>  
              <h:outputText value="#{infoMdtoColeta.dthrIngeriu}"> 
                <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/> 
              </h:outputText> 
            </p:column>  
            <p:column style="#{infoMdtoColeta.emEdicao eq true ? 'background-color:yellow;' : ''}"> 
              <f:facet name="header"> 
                <h:outputText value="#{messages.LABEL_REGISTRAR_INFORMACOES_COLETA_EXAME_DATA_HORA_COLETA}"/> 
              </f:facet>  
              <h:outputText value="#{infoMdtoColeta.dthrColetou}"> 
                <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/> 
              </h:outputText> 
            </p:column> 
          </mec:serverDataTable> 
        </p:outputPanel> 
      </aghu:linha> 
    </aghu:panelGeral>  
    <aghu:acao> 
      <p:outputPanel id="panelGravarAba1" ajaxRendered="true" layout="inline"> 
        <mec:commandButton id="bt_gravar" 
                           disabled="#{informacaoColetaController.labelPaciente eq null}" 
                           value="#{messages.LABEL_GRAVAR}" 
                           action="#{informacaoColetaController.gravar}" 
                           rendered="#{mf:hasPermission(securityController,'amostraII,executar') or mf:hasPermission(securityController,'informacaoColetaAmostra,executar')}" 
                           profile="ok" ajax="true"/> 
      </p:outputPanel> 
    </aghu:acao> 
  </ui:composition> 
</html>
