<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions" xmlns:mec="http://xmlns.jcp.org/jsf/composite/components" xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:aghu="http://xmlns.jcp.org/jsf/component" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:mf="http://www.mec.gov.br/taglib">  
  <ui:composition template="/WEB-INF/templates/form_template.xhtml"> 
    <ui:define name="head"> 
      <title>#{messages.LABEL_SOLICITACAO_USO_MEDICAMENTO}</title> 
      <style type="text/css">
		.corFundo {
			background: #01ffff;
		}
		
	</style>
    </ui:define>  
    <ui:define name="metadata"> 
     <f:metadata>
			<f:viewAction action="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.iniciar}" />
		</f:metadata>
    </ui:define>  
    <ui:define name="body"> 
      <mec:pageConfig controller="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController}"/>  
      <h:form prependId="false" id="campos"> 
        <aghu:panelGeral legend="#{messages.LABEL_PESQUISAR_SOLICITACAO_USO_MEDICAMENTO}"> 
          <aghu:linha> 
            <mec:inputTextProntuario id="codProntuario2" value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.filtro.codProntuario}" 
                                     size="10" maxlength="8" label="#{messages.LABEL_PRONTUARIO}" 
                                     title="#{messages.TITLE_PRONTUARIO2}"/>


            
            <mec:suggestionBox id="medicamento"
                    				label="#{messages.LABEL_MEDICAMENTO}" 
                    				width="420px"
                    				required="false" 
                    				size="35"
                    				descricaoLimite="35"
                    				maxlength="60"
                    				var="item"
                    				itemValue="#{item}"
                    				descricaoInput="matCodigo" 
                    				descricaoLabel="descricao" 
                    				suggestionAction="listarMedicamento" 
                    				controller="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController}" 
                    				value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.filtro.medicamento}" 
                    				title="#{messages.TITLE_MEDICAMENTO2}">
                      <p:column>
                      		<f:facet name="header">
								<b>#{messages.LABEL_DESCRICAO}</b>
							</f:facet> 
                      		#{item.descricao}
                      </p:column> 
                      <p:column>
                      		<f:facet name="header">
								<b>#{messages.LABEL_CONCENTRACAO}</b>
							</f:facet> 
                      		#{item.concentracao}
                      </p:column> 
                      <p:column>
                      		<f:facet name="header">
								<b>#{messages.LABEL_UNIDADE_MEDICA_MEDICAS}</b>
							</f:facet> 
                      		#{item.mpmUnidadeMedidaMedicas.descricao}
                      </p:column> 
                      <p:column>
                      		<f:facet name="header">
								<b>#{messages.LABEL_TPRSIGLA}</b>
							</f:facet> 
                      		#{item.tprSigla}
                      </p:column>
            </mec:suggestionBox> 
            
            <mec:selectOneMenu id="avaliador" enum="DominioIndRespAvaliacao" 
            				   style="width:80px !important"
            				   label="#{messages.LABEL_AVALIADOR}" 
            				   value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.filtro.avaliador}"
            				   title="#{messages.TITLE_AVALIADOR}">
       		</mec:selectOneMenu>
            
            <mec:selectOneMenu id="situacao" enum="DominioSituacaoSolicitacaoMedicamento" 
            				   style="width:80px !important"
            				   label="#{messages.LABEL_SITUACAO}" 
            				   value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.filtro.situacao}"
            				   title="#{messages.TITLE_SITUACAO2}">
       		</mec:selectOneMenu>        

			<mec:suggestionBox id="tipoUso"
                    				label="#{messages.LABEL_TIPO_DE_USO}" 
                    				required="false" 
                    				size="35"
                    				width="50"
                    				descricaoLimite="35"
                    				maxlength="60"
                    				var="item"
                    				itemValue="#{item}"
                    				descricaoInput="sigla" 
                    				descricaoLabel="descricao" 
                    				suggestionAction="listarTipoUso" 
                    				controller="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController}" 
                    				value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.filtro.tipoUso}" 
                    				title="#{messages.TITLE_TIPO_DE_USO}">
                      <p:column>
                      		<f:facet name="header">
								<b>#{messages.LABEL_SIGLA}</b>
							</f:facet> 
                      		#{item.sigla}
                      </p:column>  
                      <p:column>
                      		<f:facet name="header">
								<b>#{messages.LABEL_DESCRICAO}</b>
							</f:facet> 
                      		#{item.descricao}
                      </p:column> 
            </mec:suggestionBox>
          </aghu:linha> 
          
          <aghu:linha> 
		  
          <mec:suggestionBox id="grupoUso"
                    				label="#{messages.LABEL_GRUPO_DE_USO}" 
                    				required="false" 
                    				size="35"
                    				width="50"
                    				descricaoLimite="35"
                    				maxlength="60"
                    				var="item"
                    				itemValue="#{item}"
                    				descricaoInput="seq" 
                    				descricaoLabel="descricao" 
                    				suggestionAction="listarGrupoUso" 
                    				controller="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController}" 
                    				value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.filtro.grupoUsoMedicamento}" 
                    				title="#{messages.TITLE_GRUPO_DE_USO}">
                      <p:column>
                      		<f:facet name="header">
								<b>#{messages.LABEL_DESCRICAO}</b>
							</f:facet> 
                      		#{item.descricao}
                      </p:column> 
            </mec:suggestionBox>
			
			
			<mec:suggestionBox id="VAghUnidFuncional"
                    				label="#{messages.LABEL_PRESC_UNIDADE_FUNCIONAL}" 
                    				required="false" 
                    				size="35"
                    				width="50"
                    				descricaoLimite="35"
                    				maxlength="60"
                    				var="item"
                    				itemValue="#{item}"
                    				descricaoInput="seq" 
                    				descricaoLabel="andarAlaDescricao" 
                    				suggestionAction="listarVAghUnidFuncional" 
                    				controller="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController}" 
                    				value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.filtro.vAghUnidFuncional}" 
                    				title="#{messages.TITLE_PRESC_UNIDADE_FUNCIONAL}">
                      <p:column style="max-width: 2%; min-width: 2%; overflow: hidden">
                      		<f:facet name="header">
								<b>#{messages.LABEL_SEQ}</b>
							</f:facet> 
                      		#{item.seq}
                      </p:column>  
                      <p:column style="max-width: 23px; min-width: 18px; overflow: hidden">
                      		<f:facet name="header">
								<b>#{messages.LABEL_DESCRICAO}</b>
							</f:facet> 
                      		#{item.andarAlaDescricao}
                      </p:column> 
            </mec:suggestionBox>
			
            
            <mec:suggestionBox id="equipe"
                    				label="#{messages.LABEL_EQUIPE}" 
                    				required="false" 
                    				size="35"
                    				width="50"
                    				descricaoLimite="35"
                    				maxlength="60"
                    				var="item"
                    				itemValue="#{item}"
                    				descricaoInput="matricula" 
                    				descricaoLabel="responsavel" 
                    				suggestionAction="listarVMpmpProfInterna" 
                    				controller="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController}" 
                    				value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.filtro.vMpmpProfInterna}" 
                    				title="#{messages.TITLE_EQUIPE2}">
                      <p:column>
                      		<f:facet name="header">
								<b>#{messages.LABEL_RESPONSAVEL}</b>
							</f:facet> 
                      		#{item.responsavel}
                      </p:column> 
            </mec:suggestionBox>
          </aghu:linha>
          
          <aghu:linha> 
          		 <mec:suggestionBox id="medicoSolicitante"
                    				label="#{messages.LABEL_MED_SOLICITANTE}" 
                    				required="false" 
                    				size="35"
                    				width="50"
                    				descricaoLimite="35"
                    				maxlength="60"
                    				var="item"
                    				itemValue="#{item}"
                    				descricaoInput="matricula" 
                    				descricaoLabel="nome" 
                    				suggestionAction="listarVMedicoSolicitante" 
                    				controller="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController}" 
                    				value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.filtro.vMedicoSolicitante}" 
                    				title="#{messages.TITLE_MED_SOLICITANTE2}">
                      <p:column>
                      		<f:facet name="header">
								<b>#{messages.LABEL_NOME}</b>
							</f:facet> 
                      		#{item.nome}
                      </p:column> 
                      <p:column>
                      		<f:facet name="header">
								<b>#{messages.LABEL_REGISTRO}</b>
							</f:facet> 
                      		#{item.nroRegConselho}
                      </p:column>
                 </mec:suggestionBox>
          		<mec:inputTextData label="#{messages.LABEL_DATA_INICIO}"
          			 title="#{messages.TITLE_PRESC_DATA_INICIO}"
          			 id="dataInicio" size="10" 
          			 value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.filtro.dataInicio}" tipo="data"/>
          		<mec:inputTextData label="#{messages.LABEL_DATA_FIM}" 
          			 title="#{messages.TITLE_PRESC_DATA_FIM}" 
          			 id="dataFim" size="10" 
          			 value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.filtro.dataFim}" tipo="data"/>
          		<mec:selectOneMenu id="indAntiMicrobianos" 
          			enum="DominioSimNao" 
          			label="#{messages.LABEL_IND_ANTIMICROBIANOS}" 
          			title="#{messages.TITLE_IND_ANTIMICROBIANOS}" 
          			value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.filtro.indAntimicrobianos}"/>
          </aghu:linha>
        </aghu:panelGeral>  
        <aghu:acao> 
          <mec:commandButton id="bt_pesquisar" value="#{messages.LABEL_PESQUISAR}" block="true" action="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.pesquisar}" profile="search"/>  
          <mec:commandButton id="bt_limpar" value="#{messages.LABEL_LIMPAR}" action="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.limpar}" profile="clear" ajax="true" render="campos, formLista" process="@this"/>  
        </aghu:acao> 
        <h:form prependId="false" id="formLista"> 
        	<h:panelGroup id="panelLista" rendered="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.dataModel.pesquisaAtiva}" > 
				<aghu:panelGeral legend="#{messages.LABEL_SOLICITACAO_USO_MEDICAMENTO}">
					<aghu:linha>  
						<mec:serverDataTable dataModel="dataModel"  
						id="tabelaSolicitacaoUsoPaciente" rowKeyVar="rowIndex"
						selection="itemSelecionado" onRowClick="itemSelecionado" 
						controller="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController}"> 
							    <c:set var="p" value="#{item}"/>  
							    <p:column id="colJustificativa"  style="width:1%" exportable="false" styleClass="#{p.indGmr eq 'S' ? 'corFundo': ''}"> 
									<f:facet name="header"/>

									<mec:commandLink id="link_justificativa" profile="view" title="#{messages.LABEL_JUSTIFICATIVA}" ajax="true"
											action="#{visualizarJustificativaUsoMedicamentoController.iniciar}">
										<f:setPropertyActionListener target="#{visualizarJustificativaUsoMedicamentoController.jumSeq}" value="#{p.jumSeq}"
												for="command" />
										<f:setPropertyActionListener target="#{visualizarJustificativaUsoMedicamentoController.matCodigo}"
												value="#{p.medMatCodigo}" for="command" />
									</mec:commandLink>
							    </p:column>  
							    <p:column id="colNomePaciente" style="width:13%" exportable="false" styleClass="#{p.indGmr eq 'S' ? 'corFundo': ''}"> 
									<f:facet name="header"> 
									  <h:outputText value="#{messages.LABEL_MPM_NOME_PACIENTE}"/> 
									</f:facet>              
									  <h:outputText id="outputTextNomePaciente" value="#{p.nomePaciente}" />  
									  <p:overlayPanel id="hintNomePaciente" for="outputTextNomePaciente"
											showEvent="mouseover" hideEvent="mouseout"
											rendered="#{p.indGmr eq 'S'}">
											<h:outputText value="#{messages.LABEL_MPM_MSG_GERME_MULTIRESISTENTE}" />
									  </p:overlayPanel>
							    </p:column>  
							    <p:column id="numProntuario" style="width:6%" exportable="false" styleClass="#{p.indGmr eq 'S' ? 'corFundo': ''}"> 
									<f:facet name="header"> 
									  <h:outputText value="#{messages.LABEL_PRONTUARIO}"/> 
									</f:facet>  
									<h:outputText id="outputTextCodigo" value="#{p.prontuario}"/>  
							    </p:column>  
							    <p:column id="local" style="width:5%" exportable="false" styleClass="#{p.indGmr eq 'S' ? 'corFundo': ''}"> 
									<f:facet name="header"> 
									  <h:outputText value="#{messages.LABEL_LOCAL}"/> 
									</f:facet>  
									<h:outputText id="outputBuscarLocalPaciente" value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.truncaLocalPaciente(pesquisarSolicitacoesUsoMedicamentoPaginatorController.buscarResumoLocalPaciente(p))}" />
									<p:overlayPanel id="hintLocalPaciente" for="outputBuscarLocalPaciente"
											showEvent="mouseover" hideEvent="mouseout"
											rendered="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.buscarResumoLocalPaciente(p).length() > 10}">
											<h:outputText value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.buscarResumoLocalPaciente(p)}" />
									</p:overlayPanel> 
							    </p:column>  
							    <p:column id="descMedicamento" style="width:13%" exportable="false" styleClass="#{p.indGmr eq 'S' ? 'corFundo': ''}"> 
									<f:facet name="header"> 
									  <h:outputText value="#{messages.LABEL_MEDICAMENTO}"/> 
									</f:facet>  
									<h:outputText id="outputTextDescMed" value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.truncaString(p.descricaoMed)}"/>
									<p:overlayPanel id="hintDescMed" for="outputTextDescMed"
											showEvent="mouseover" hideEvent="mouseout"
											rendered="#{p.descricaoMed.length() > 20}">
											<h:outputText value="#{p.descricaoMed}" />
									</p:overlayPanel>  
							    </p:column>  
							    <p:column id="nomeSolicitante" style="width:13%" exportable="false" styleClass="#{p.indGmr eq 'S' ? 'corFundo': ''}"> 
									<f:facet name="header"> 
									  <h:outputText value="#{messages.LABEL_SOLICITANTE}"/> 
									</f:facet>  
									<h:outputText id="outputTextnomeSolicitante" value="#{pesquisarSolicitacoesUsoMedicamentoPaginatorController.truncaString(p.nomeSolicitante)}"/>
									<p:overlayPanel id="hintNomeSolicitante" for="outputTextnomeSolicitante"
											showEvent="mouseover" hideEvent="mouseout"
											rendered="#{p.nomeSolicitante.length() > 20}">
											<h:outputText value="#{p.nomeSolicitante}" />
									</p:overlayPanel>  
								</p:column> 
								<p:column id="dataSolicitacao" style="width:7%" exportable="false" styleClass="#{p.indGmr eq 'S' ? 'corFundo': ''}"> 
									<f:facet name="header"> 
									  <h:outputText value="#{messages.LABEL_DATA_SOLICITACAO}"/> 
									</f:facet>  
									<h:outputText id="outputTextDt" value="#{p.criadoEm}"> 
										<f:convertDateTime pattern="dd/MM/yyyy HH:mm"/> 
									</h:outputText> 
								</p:column>
								<p:column id="situacao" style="width:9%" exportable="false" styleClass="#{p.indGmr eq 'S' ? 'corFundo': ''}"> 
									<f:facet name="header"> 
									  <h:outputText value="#{messages.LABEL_SITUACAO}"/> 
									</f:facet>  
									<h:outputText id="outputTextIndSituacao" value="#{p.retornarPorExtenso()}"/> 
								</p:column>
						</mec:serverDataTable>
					</aghu:linha>
				</aghu:panelGeral>
			</h:panelGroup> 
		</h:form>
      </h:form>  

    </ui:define> 
  </ui:composition> 
</html>
