<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions" xmlns:mec="http://xmlns.jcp.org/jsf/composite/components" xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:aghu="http://xmlns.jcp.org/jsf/component" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:mf="http://www.mec.gov.br/taglib">  
  <ui:composition template="/WEB-INF/templates/form_template.xhtml"> 
    <ui:define name="head"> 
      <title>Solicitacao de Compras :: AGHU - MEC</title> 
    </ui:define>  
    <ui:define name="body"> 
      <mec:pageConfig controller="#{imprimirRelatorioExcelController}"/>  
      <h:form prependId="false" id="Relatorio">
        <aghu:panelGeral legend="#{messages.RELATORIO_EXCEL_LEGENDA}"> 
          <p:outputPanel id="fields" layout="inline"> 
            <aghu:linha> 
              <mec:suggestionBox label="#{messages.RELATORIO_EXCEL_LABEL_GRUPO_MATERIAL}" title="#{messages.RELATORIO_EXCEL_TITLE_GRUPO_MATERIAL}" descricaoInput="codigo" descricaoLabel="descricao" suggestionAction="pesquisarGruposMateriais" width="500" rendered="#{imprimirRelatorioExcelController.relatorioSelecionado eq 'AF'}" id="suggestionGrupoMaterial" controller="#{imprimirRelatorioExcelController}" value="#{imprimirRelatorioExcelController.grupoMaterial}"> 
                <p:column> 
                  <f:facet name="header"> 
                    <h:outputText value="#{messages.LABEL_CODIGO}" style="font-weight: bold;"/> 
                  </f:facet> #{item.codigo}
                </p:column>  
                <p:column> 
                  <f:facet name="header"> 
                    <h:outputText value="#{messages.LABEL_DESCRICAO}" style="font-weight: bold;"/> 
                  </f:facet> #{item.descricao}
                </p:column>  
                <p:column> 
                  <f:facet name="header"> 
                    <h:outputText value="#{messages.LABEL_INDICADOR_PARAMETRO_ORCAMENTO}" style="font-weight: bold;"/> 
                  </f:facet> #{item.indicador.descricao}
                </p:column> 
              </mec:suggestionBox>  
              <mec:suggestionBox label="#{messages.RELATORIO_EXCEL_LABEL_MATERIAL}" title="#{messages.RELATORIO_EXCEL_TITLE_MATERIAL}" descricaoInput="codigo" descricaoLabel="descricao" suggestionAction="pesquisarMaterial" width="500" rendered="#{imprimirRelatorioExcelController.relatorioSelecionado eq 'AF'}" id="suggestionMaterial" controller="#{imprimirRelatorioExcelController}" value="#{imprimirRelatorioExcelController.material}"> 
                <p:column> 
                  <f:facet name="header"> 
                    <h:outputText value="#{messages.LABEL_CODIGO}" style="font-weight: bold;"/> 
                  </f:facet> #{item.codigo}
                </p:column>  
                <p:column> 
                  <f:facet name="header"> 
                    <h:outputText value="#{messages.LABEL_SCO_MATERIAL_NOME}" style="font-weight: bold;"/> 
                  </f:facet> #{item.nome}
                </p:column> 
              </mec:suggestionBox>  
              <mec:inputNumero id="numeroPac" label="#{messages.LABEL_RELATORIO_EXCEL_NUMERO_PAC}" title="#{messages.TITLE_RELATORIO_EXCEL_NUMERO_PAC}" size="10" maxlength="7" rendered="#{imprimirRelatorioExcelController.relatorioSelecionado eq 'AP'}" value="#{imprimirRelatorioExcelController.numeroPac}" required="true"/>  
              <mec:inputNumero id="anoEP" label="#{messages.LABEL_RELATORIO_EXCEL_ANO}" title="#{messages.TITLE_RELATORIO_EXCEL_ANO}" size="5" maxlength="4" rendered="#{imprimirRelatorioExcelController.relatorioSelecionado eq 'EP'}" value="#{imprimirRelatorioExcelController.anoEP}" required="true"/> 
            </aghu:linha> 
          </p:outputPanel>  
          <p:outputPanel id="options" layout="inline"> 
            <aghu:linha> 
              <mec:selectOneRadio id="tipoRelatorio" value="#{imprimirRelatorioExcelController.tipoRelatorio}" layout="pageDirection"> 
                <p:ajax event="click" update="@(#fields)" process="@this" listener="#{imprimirRelatorioExcelController.validaTipoRelatorio}"/>
	               	<f:selectItem id="idItem0" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[0].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[0]}" />
	               	<f:selectItem id="idItem1" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[1].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[1]}" />
	               	<f:selectItem id="idItem2" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[2].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[2]}" />
	               	<f:selectItem id="idItem3" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[3].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[3]}" />
	               	<f:selectItem id="idItem4" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[4].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[4]}" />
	               	<f:selectItem id="idItem5" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[5].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[5]}" />
	               	<f:selectItem id="idItem6" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[6].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[6]}" />
	               	<f:selectItem id="idItem7" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[7].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[7]}" />
	               	<f:selectItem id="idItem8" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[8].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[8]}" />
	               	<f:selectItem id="idItem9" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[9].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[9]}" itemDisabled="#{not mf:hasPermission(securityController,'consultarESEntradasSemEmpenhoOuAssinatura,imprimir')}" />
	               	<f:selectItem id="idItem10" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[10].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[10]}" />
	               	<f:selectItem id="idItem11" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[11].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[11]}" />
	               	<f:selectItem id="idItem12" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[12].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[12]}" />
	               	<f:selectItem id="idItem13" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[13].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[13]}" />
	               	<f:selectItem id="idItem14" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[14].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[14]}" />
	               	<f:selectItem id="idItem15" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[15].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[15]}" />
	               	<f:selectItem id="idItem16" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[16].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[16]}" />
	               	<f:selectItem id="idItem17" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[17].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[17]}" />
	               	<f:selectItem id="idItem18" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[18].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[18]}" />
	               	<f:selectItem id="idItem19" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[19].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[19]}" />
	               	<f:selectItem id="idItem20" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[20].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[20]}" />
	               	<f:selectItem id="idItem21" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[21].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[21]}" />
	               	<f:selectItem id="idItem22" itemLabel="#{imprimirRelatorioExcelController.listarTiposRelatorios()[22].descricao}"
	                      itemValue="#{imprimirRelatorioExcelController.listarTiposRelatorios()[22]}" />
                
              </mec:selectOneRadio> 
            </aghu:linha> 
          </p:outputPanel> 
        </aghu:panelGeral>  
        <p:outputPanel id="action" layout="inline"> 
          <aghu:acao> 
            <p:outputPanel id="imprimirPanel" layout="inline"> 
	           <mec:commandButton id="btImprimir"											
							value="#{messages.LABEL_GERAR_EXCEL}"
							action="#{imprimirRelatorioExcelController.gerarArquivo()}"						
							styleClass=" icon-download-csv bt_cinza">
							<f:param name="cid"
								value="#{javax.enterprise.context.conversation.id}" />
			  </mec:commandButton> 
		   </p:outputPanel> 
          </aghu:acao> 
        </p:outputPanel> 
      </h:form> 
    </ui:define> 
  </ui:composition> 
</html>
