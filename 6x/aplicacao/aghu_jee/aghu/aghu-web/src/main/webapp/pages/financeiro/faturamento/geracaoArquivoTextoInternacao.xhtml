<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions" xmlns:mec="http://xmlns.jcp.org/jsf/composite/components" xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:aghu="http://xmlns.jcp.org/jsf/component" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:mf="http://www.mec.gov.br/taglib">  
  <ui:composition template="/WEB-INF/templates/form_template.xhtml"> 
    <ui:define name="head"> 
      <title>#{messages.TITLE_GERACAO_ARQUIVO_TEXTO_INTERNACAO} :: #{messages.NOME_ABREVIADO_PROJETO}</title> 
    </ui:define>  
    
    <ui:define name="body">
    
      <mec:pageConfig controller="#{geracaoArquivoTextoInternacaoController}" ignoreEnter="true" />
     
      <h:form prependId="false" id="formCadastro">
        <aghu:panelGeral id="id_panelGeral" legend="#{messages.TITLE_GERAR_ARQUIVO_TEXTO_INTERNACAO}"> 
          <aghu:linha> 
            <mec:suggestionBox id="competencia" prependId="false" label="#{messages.LABEL_COMPETENCIA}" title="#{messages.TITLE_COMPETENCIA}" descricaoInput="mesAno" descricaoLabel="data" suggestionAction="pesquisarCompetencias" width="400" controller="#{geracaoArquivoTextoInternacaoController}" value="#{geracaoArquivoTextoInternacaoController.competencia}"> 
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_MES}</b> 
                </f:facet> #{item.id.mes}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_ANO_COMPETENCIA}</b> 
                </f:facet> #{item.id.ano}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <b>#{messages.LABEL_DATA_HORA_COMPETENCIA}</b> 
                </f:facet>  
                <h:outputText id="id_dataInicioSuggestionCompetencia" value="#{item.id.dtHrInicio}"> 
                  <f:convertDateTime type="both" pattern="dd/MM/yyyy HH:mm"/> 
                </h:outputText> 
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha> 
        </aghu:panelGeral>  
        <aghu:linha> 
          <aghu:panelGeral id="id_panelBotoesGeracaoArquivos" legend="#{messages.TITLE_OPCOES_PARA_GERAR_ARQUIVO}"> 
            <aghu:linha> 
              <table width="100%"> 
                <tr> 
                  <td style="padding-top: 2px; width: 28%;" rowspan="1" colspan="1"> 
                    <div> 
                      <mec:commandButton id="bt_contasReapresentadas" value="#{messages.LABEL_CONTAS_REAPRESENTADAS}" action="#{geracaoArquivoTextoInternacaoController.gerarCSVDadosContaRepresentada}" title="#{messages.TITLE_BT_CONTA_REPRESENTADA}"  style="width: 98%; font-size:10px!important;" onclick="PF('loadDialogWG').show();;" disabled="false" styleClass="bt_cinza"> 
                        <f:param name="cid" value="#{javax.enterprise.context.conversation.id}"/> 
                      </mec:commandButton> 
                    </div> 
                  </td>  
                  <td style="padding-top: 2px; width: 28%;" rowspan="1" colspan="1"> 
                    <div> 
                      <mec:commandButton title="#{messages.TITLE_BOTAO_CSV}" id="bt_contasNutricaoParenteral" value="#{messages.LABEL_CONTAS_NUTRICAO_PARENTERAL_NPT}" style="width: 98%;" action="#{geracaoArquivoTextoInternacaoController.gerarCSVContas}" onclick="PF('loadDialogWG').show();;" styleClass="bt_cinza"/>
                    </div> 
                  </td>  
                  <td style="padding-top: 2px; width: 28%;" rowspan="1" colspan="1"> 
                    <div> 
                      <mec:commandButton id="bt_contasPeriodo" value="#{messages.LABEL_CONTAS_PERIODO}" action="#{geracaoArquivoTextoInternacaoController.contasPeriodo}" style="width: 98%; font-size:10px!important;" styleClass="bt_cinza"/>
                    </div> 
                  </td> 
                </tr>  
                <tr> 
                  <td style="padding-top: 2px; width: 28%;" rowspan="1" colspan="1"> 
                    <div> 
                      <mec:commandButton id="bt_contasNaoReapresentadas" value="#{messages.LABEL_CONTAS_NAO_REAPRESENTADAS_CPF}" title="#{messages.TITLE_CONTAS_NAO_REAPRESENTADAS_CPF}" action="#{geracaoArquivoTextoInternacaoController.gerarCSVContasNaoReap}" style="width: 98%; font-size:10px!important;" disabled="false" styleClass="bt_cinza"/> 
                    </div> 
                  </td>  
                  <td style="padding-top: 2px; width: 28%;" rowspan="1" colspan="1"> 
                    <div> 
                      <mec:commandButton title="#{messages.TITLE_CONTAS_NPE_COM_DIG}" id="bt_contasNpeComDig" value="#{messages.LABEL_CONTAS_NPE_COM_DIG}"  action="#{geracaoArquivoTextoInternacaoController.gerarCSVNutricaoEnteralDigitada}" onclick="PF('loadDialogWG').show();;" style="width: 98%;" disabled="false" styleClass="bt_cinza">
                    	<f:param name="cid" value="#{javax.enterprise.context.conversation.id}"/> 
                      </mec:commandButton> 
                    </div> 
                  </td>  
                  <td style="padding-top: 2px; width: 28%;" rowspan="1" colspan="1"> 
                    <div> 
                      <mec:commandButton id="bt_contasNptComDig" value="#{messages.LABEL_CONTAS_NPT_COM_DIG}" title="#{messages.TITLE_BT_CONTAS_COM_NPT}" action="#{geracaoArquivoTextoInternacaoController.gerarCSVDadosContasComNPT}" style="width: 98%; font-size:10px!important;" disabled="false" styleClass="bt_cinza"/> 
                    </div> 
                  </td> 
                </tr>  
                <tr> 
                  <td style="padding-top: 2px; width: 28%;" rowspan="1" colspan="1"> 
                    <div> 
                      <mec:commandButton id="bt_vinculo956" value="#{messages.LABEL_VINCULO_INCORRETO}" title="#{messages.TITLE_VINCULO_INCORRETO}" action="#{geracaoArquivoTextoInternacaoController.gerarCSVContasProcedProfissionalVinculoIncorreto}" style="width: 98%; font-size:10px!important;" disabled="false" styleClass="bt_cinza"/> 
                    </div> 
                  </td>  
                  <td style="padding-top: 2px; width: 28%;" rowspan="1" colspan="1"> 
                    <div> 
                      <mec:commandButton id="bt_diasNutricaoEnteral" value="#{messages.LABEL_DIAS_NUTRICAO_ENTERAL}" action="#{geracaoArquivoTextoInternacaoController.gerarCSVNutricaoEnteral}" title="#{messages.TITLE_BT_CONTAS_CONTAS_NUTRICAO}" style="width: 98%; font-size:10px!important;" styleClass="bt_cinza"/> 
                    </div> 
                  </td>  
                  <td style="padding-top: 2px; width: 28%;" rowspan="1" colspan="1"> 
                    <div> 
                      <mec:commandButton id="bt_produtividadeFisiatria" action="#{geracaoArquivoTextoInternacaoController.gerarCSVProdutividadeFisiatria}" 
                      		value="#{messages.LABEL_PRODUTIVIDADE_FISIATRIA}" title="#{messages.HINT_BOTAO_PRODUTIVIDADE_FISIATRIA}"
                      		onclick="PF('loadDialogWG').show();" oncomplete="PF('loadDialogWG').hide();"
                      		style="width: 98%; font-size:10px!important;" styleClass="bt_cinza" />                       
                    </div> 
                  </td> 
                </tr> 
              </table> 
            </aghu:linha> 
          </aghu:panelGeral> 
        </aghu:linha> 
      </h:form>  
      <p:dialog id="LoadingModalBox" style="text-align:center;" height="200" top="200" resizeable="false" moveable="false" width="400" zindex="2000" modal="true" resizable="false" widgetVar="LoadingModalBoxWG"> 
        <f:facet name="header"> 
          <h:outputText value="Em Andamento"/> 
        </f:facet>  
        <div style="text-align:center;"> 
          <br clear="none"/>  
          <br clear="none"/>  
          <h:graphicImage value="/resources/img/loading_panel.gif"/>  
          <br clear="none"/>  
          <br clear="none"/>  
          <h:outputText value="#{mf:getDefaultValue(blockMsg,'Processando, por favor aguarde.')}"/> 
        </div> 
      </p:dialog>  
      <p:dialog id="modalConfirmacaoGerArqParcial" width="360" height="150" modal="true" resizable="false" widgetVar="modalConfirmacaoGerArqParcialWG"> 
        <f:facet name="header"> 
          <h:panelGroup> 
            <h:outputText value="#{messages.LABEL_GERAR_ARQUIVO_PARCIAL}"/> 
          </h:panelGroup> 
        </f:facet> #{messages.MENSAGEM_GERACAO_ARQUIVO_PARCIAL_ENCERRAMENTO_COMPETENCIA} 
        <br clear="none"/>  
        <br clear="none"/>  
        <br clear="none"/>  
        <h:panelGroup> 
          <h:form prependId="false" id="formModalConfirmacaoGerArqParcial"> 
            <aghu:linha> 
              <mec:commandButton id="bt_okModalConfirmacaoGerArqParcial" value="#{messages.LABEL_SIM}" onclick="PF('loadDialogWG').show();;" action="#{encerramentoCompetenciaInternacaoController.gerarArquivoParcial}" profile="search"/>  
              <mec:commandButton id="bt_cancelarModalConfirmacaoGerArqParcial" value="#{messages.LABEL_NAO}" onclick="PF('modalConfirmacaoGerArqParcialWG').hide();" profile="cancel" ajax="true"/> 
            </aghu:linha> 
          </h:form> 
        </h:panelGroup> 
      </p:dialog> 
      <h:form prependId="false" id="formButton">
      	<c:if xmlns:c="http://java.sun.com/jstl/core" test="#{geracaoArquivoTextoInternacaoController.gerouArquivoNutricaoEnteral}">  
          <script type="text/javascript" xml:space="preserve">
					jQuery(document).ready(function(){
						document.getElementById('abrirArquivoButtonNutricao:button').click();
					});
				</script>  
          <mec:commandButton id="abrirArquivoButtonNutricao" immediate="true" action="#{geracaoArquivoTextoInternacaoController.dispararDownloadNutricaoEnteralDigitada()}" value="Download do arquivo" style="visibility: hidden;" styleClass="bt_cinza"> 
            <f:param name="cid" value="#{javax.enterprise.context.conversation.id}"/> 
          </mec:commandButton>          
        </c:if>
        <c:if xmlns:c="http://java.sun.com/jstl/core" test="#{geracaoArquivoTextoInternacaoController.gerouArquivoContas}">  
          <script type="text/javascript" xml:space="preserve">
					jQuery(document).ready(function(){
						document.getElementById('abrirArquivoButtonContas:button').click();
					});
				</script>  
          <mec:commandButton id="abrirArquivoButtonContas" immediate="true" action="#{geracaoArquivoTextoInternacaoController.dispararDownloadContas()}" value="Download do arquivo" style="visibility: hidden;" styleClass="bt_cinza"> 
            <f:param name="cid" value="#{javax.enterprise.context.conversation.id}"/> 
          </mec:commandButton>          
        </c:if> 
      </h:form> 

      <h:form prependId="false" id="formBotaoDownload"> 
      	<c:if xmlns:c="http://java.sun.com/jstl/core" test="#{geracaoArquivoTextoInternacaoController.gerouArquivoCSV}"> 
      		<script type="text/javascript" xml:space="preserve">
					jQuery(document).ready(function() {
						document.getElementById('bt_download_csv:button').click();
					});
			</script>       		
	      	<mec:commandButton id="bt_download_csv" immediate="true" 
					action="#{geracaoArquivoTextoInternacaoController.dispararDownloadArquivo}" 
					value="Download do arquivo 1" style="visibility: hidden;" styleClass="bt_cinza" />
      	</c:if>
        <c:if xmlns:c="http://java.sun.com/jstl/core" test="#{geracaoArquivoTextoInternacaoController.gerouArquivo}">  
        	<script type="text/javascript" xml:space="preserve">
					jQuery(document).ready(function(){
						document.getElementById('abrirArquivoButton:button').click();
					});
			</script>  
	        <mec:commandButton id="abrirArquivoButton" immediate="true"
	        		action="#{geracaoArquivoTextoInternacaoController.dispararDownloadArquivo}"
	        		value="Download do arquivo 2" style="visibility: hidden;" styleClass="bt_cinza"> 
	          <f:param name="cid" value="#{javax.enterprise.context.conversation.id}"/> 
	        </mec:commandButton>          
        </c:if> 
		</h:form>
    </ui:define> 
  </ui:composition> 
</html>
