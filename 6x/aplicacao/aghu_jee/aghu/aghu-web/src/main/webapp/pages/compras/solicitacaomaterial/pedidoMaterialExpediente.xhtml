<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions" xmlns:mec="http://xmlns.jcp.org/jsf/composite/components" xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:aghu="http://xmlns.jcp.org/jsf/component" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:mf="http://www.mec.gov.br/taglib">  
  <ui:composition xmlns:fn="http://java.sun.com/jsp/jstl/functions" template="/WEB-INF/templates/form_template.xhtml">  
    <ui:define name="head"> 
      <title>#{messages.TITLE_DETALHES_PEDIDO_MAT_EXPEDIENTE} :: #{messages.NOME_ABREVIADO_PROJETO}</title> 
    </ui:define>  
    <ui:define name="metadata"> 
      <f:metadata> 
        <f:viewAction action="#{pedidoMaterialExpedienteController.iniciar}"/> 
      </f:metadata> 
    </ui:define>  
    <ui:define name="body"> 
      <mec:pageConfig controller="#{pedidoMaterialExpedienteController}" ignoreEnter="true"/>  
      <h:form prependId="false" id="pedidoDetalhesId"> 
        <aghu:panelGeral legend="#{messages.TITLE_DETALHES_PEDIDO_MAT_EXPEDIENTE}"> 
          <aghu:linha> 
            <mec:inputNumero id="pedidoId" readonly="true" label="#{messages.LABEL_PEDIDO_MAT_EXPEDIENTE}" size="12" value="#{pedidoMaterialExpedienteController.pedido.numeroPedido}"/>  
            <mec:inputNumero id="ccId" readonly="true" label="#{messages.LABEL_CENTRO_CUSTO_PEDIDO_MAT_EXPEDIENTE}" size="8" value="#{pedidoMaterialExpedienteController.pedido.centroCusto.codigo}"/>  
            <mec:inputText id="ccDescId" label="#{messages.LABEL_CC_DESC_PEDIDO_MAT_EXPEDIENTE}" value="#{pedidoMaterialExpedienteController.pedido.centroCusto.descricao}" size="100" readonly="true"/>  
            <mec:selectBooleanCheckbox label="#{messages.LABEL_CONFERIDO_PEDIDO_MAT_EXPEDIENTE}" title="#{messages.TITLE_CRUD_ATIVO_NACIONALIDADE}" value="#{pedidoMaterialExpedienteController.indValidacaoPedido}" readonly="true" id="pedConfId"/> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputTextData label="#{messages.LABEL_DATA_DO_PEDIDO_MAT_EXPEDIENTE}" id="dtPedidoId" value="#{pedidoMaterialExpedienteController.pedido.dataPedido}" readonly="true" tipo="data"/>  
            <mec:inputText id="solMatId" readonly="true" label="#{messages.LABEL_SOLICITANTE_PEDIDO_MAT_EXPEDIENTE}" size="8" value="#{pedidoMaterialExpedienteController.pedido.servidorSolicitante.matriculaVinculo}"/>  
            <mec:inputText id="solDescId" label="#{messages.LABEL_SOLICITANTE_DESC_PEDIDO_MAT_EXPEDIENTE}" value="#{pedidoMaterialExpedienteController.pedido.servidorSolicitante.pessoaFisica.nome}" size="100" readonly="true"/> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputTextData label="#{messages.LABEL_DT_REC_PEDIDO_MAT_EXPEDIENTE}" id="dtRecId" value="#{pedidoMaterialExpedienteController.pedido.dataRecebimento}" readonly="true" tipo="data"/>  
            <mec:inputText id="confMatId" readonly="true" label="#{messages.LABEL_CONFERENTE_PEDIDO_MAT_EXPEDIENTE}" size="8" value="#{pedidoMaterialExpedienteController.pedido.servidorConferente.matriculaVinculo}"/>  
            <mec:inputText id="solConfId" label="#{messages.LABEL_CONF_DESC_PEDIDO_MAT_EXPEDIENTE}" value="#{pedidoMaterialExpedienteController.pedido.servidorConferente.pessoaFisica.nome}" size="100" readonly="true"/>  
            <mec:inputTextData label="#{messages.LABEL_DT_CONF_PEDIDO_MAT_EXPEDIENTE}" id="dtConfId" value="#{pedidoMaterialExpedienteController.pedido.dataConferencia}" readonly="true" tipo="data"/> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputText id="comentId" label="#{messages.LABEL_COMENTARIOS_PEDIDO_MAT_EXPEDIENTE}" value="#{pedidoMaterialExpedienteController.pedido.comentarios}" size="200" maxlength="1000" readonly="true"/> 
          </aghu:linha> 
        </aghu:panelGeral> 
      </h:form>  
      <h:form prependId="false" id="formItensPedido"> 
        <aghu:linha> 
          <p:outputPanel id="panelResultado" layout="inline"> 
            <p:outputPanel style="width:100%; height:100px; overflow-y:scroll;" layout="inline"> 
              <mec:serverDataTable id="tbItensPedido" list="#{pedidoMaterialExpedienteController.pedido.listaItens}" scrollable="true"> 
                <c:set var="_item" value="#{item}"/>  
                <p:column> 
                  <f:facet name="header"> 
                    <h:outputText value="#{messages.LABEL_COD_PEDIDO_MAT_EXPEDIENTE_ITEM}"/> 
                  </f:facet>  
                  <h:outputText value="#{_item.material.codigo}"/> 
                </p:column>  
                <p:column> 
                  <f:facet name="header"> 
                    <h:outputText value="#{messages.LABEL_DESC_PEDIDO_MAT_EXPEDIENTE_ITEM}"/> 
                  </f:facet>  
                  <h:outputText value="#{_item.material.nome}"/> 
                </p:column>  
                <p:column> 
                  <f:facet name="header"> 
                    <h:outputText value="#{messages.LABEL_QTDE_PEDIDO_MAT_EXPEDIENTE_ITEM}"/> 
                  </f:facet>  
                  <h:outputText value="#{_item.quantidade}"/> 
                </p:column>  
                <p:column> 
                  <f:facet name="header"> 
                    <h:outputText value="#{messages.LABEL_UNID_MED_PEDIDO_MAT_EXPEDIENTE_ITEM}"/> 
                  </f:facet>  
                  <h:outputText value="#{_item.material.unidadeMedida.descricao}"/> 
                </p:column>  
                <p:column> 
                  <f:facet name="header"> 
                    <h:outputText value="#{messages.LABEL_VLR_UNT_PEDIDO_MAT_EXPEDIENTE_ITEM}"/> 
                  </f:facet>  
                  <h:outputText value="#{_item.valorUnitario}" styleClass="mascara(decimal)}"> 
                    <f:converter converterId="currencyConverter"/> 
                  </h:outputText> 
                </p:column>  
                <p:column> 
                  <f:facet name="header"> 
                    <h:outputText value="#{messages.LABEL_VLR_TOTAL_PEDIDO_MAT_EXPEDIENTE_ITEM}"/> 
                  </f:facet>  
                  <h:outputText value="#{_item.valorTotal}" styleClass="mascara(decimal)}"> 
                    <f:converter converterId="currencyConverter"/> 
                  </h:outputText> 
                </p:column>  
                
              </mec:serverDataTable> 
            </p:outputPanel>  
            <div style="float:right; width:350px;"> 
              <mec:inputNumero id="vlTotal" label="#{messages.LABEL_TOTAL_PEDIDO_MAT_EXPEDIENTE}" size="35" value="#{pedidoMaterialExpedienteController.pedido.valorTotal}" readonly="true"/> 
            </div> 
          </p:outputPanel> 
        </aghu:linha>  
        <aghu:acao> 
          <mec:commandButton id="bt_conferir" value="#{messages.LABEL_BT_CONFERIDO_PEDIDO_MAT_EXPEDIENTE}" disabled="#{pedidoMaterialExpedienteController.pedido.indValidacaoPedido or pedidoMaterialExpedienteController.pedido.servidorConferente != null}" action="#{pedidoMaterialExpedienteController.conferir}" profile="search"/>  
          <p:commandButton id="bt_recusar" value="#{messages.LABEL_BT_RECUSADO_PEDIDO_MAT_EXPEDIENTE}"  type="button"
         	 disabled="#{pedidoMaterialExpedienteController.pedido.indValidacaoPedido or pedidoMaterialExpedienteController.pedido.servidorConferente != null}"  
        	 styleClass="button-acao bt_cancel_edit  bt_cinza" onclick="PF('cd_bt_recusar').show()">
	          <p:confirmDialog width="400" height="150" closable="false" showEffect="fade" hideEffect="fade" 
	          	header="#{messages.TITLE_ENVIA_EMAIL_FORNECEDOR}" message="#{messages.MENSAGEM_ENVIA_EMAIL_FORNECEDOR}"
	          	widgetVar="cd_bt_recusar">
	          		<p:commandButton styleClass="button-acao bt_secund icon-yes"
								value="#{messages.LABEL_SIM}" type="button"
								immediate="true" action="#{pedidoMaterialExpedienteController.recusar()}"
								id="bt_recusar_sim" update="@form" oncomplete="PF('cd_bt_recusar').hide()"/>
					<p:commandButton styleClass="button-acao bt_error icon-no" style="float: right;"
								value="#{messages.LABEL_NAO}"
								type="button" onclick="PF('cd_bt_recusar').hide()"
								id="bt_cancelarAprovacao"/>
	          </p:confirmDialog>
          </p:commandButton>  
          <mec:commandButton id="bt_voltar" value="#{messages.LABEL_BT_VOLTAR_PEDIDO_MAT_EXPEDIENTE}" action="#{pedidoMaterialExpedienteController.cancelar}" profile="back" style="float: right;"/> 
        </aghu:acao> 
	  </h:form>	
    </ui:define> 
  </ui:composition> 
</html>