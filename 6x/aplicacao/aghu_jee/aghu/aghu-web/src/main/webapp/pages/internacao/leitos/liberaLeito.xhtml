<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions" xmlns:mec="http://xmlns.jcp.org/jsf/composite/components" xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:aghu="http://xmlns.jcp.org/jsf/component" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:mf="http://www.mec.gov.br/taglib">  
  <ui:composition template="/WEB-INF/templates/form_template.xhtml"> 
    <ui:define name="head"> 
      <title>Liberar Leito:: AGHU - MEC</title> 
    </ui:define>  
    <ui:define name="metadata"> 
      <f:metadata> 
        <f:viewAction action="#{liberaLeitoController.inicio}"/> 
      </f:metadata> 
    </ui:define>  
    <ui:define name="body"> 
      <mec:pageConfig controller="#{liberaLeitoController}"/>  
      <h:form prependId="false" id="formPesquisa"> 
        <aghu:panelGeral id="ffdl_liberar" legend="Liberar Leito"> 
          <aghu:linha> 
            <mec:suggestionBox id="suggestionLeitos" required="true" styleClassField="frm_obrigatorio" label="#{messages.LABEL_LEITO}" title="#{messages.TITLE_LABEL_LEITO_LIBERAR}" descricaoInput="leitoID" size="10" maxlength="45" width="600" disabled="false" descricaoLabel="unidadeFuncional.LPADAndarAlaDescricao" suggestionAction="pesquisarLeitosDesocupados" controller="#{liberaLeitoController}" value="#{liberaLeitoController.leitos}" render="situacao"> 
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_LEITO}"/> 
                </f:facet>  
                <h:outputText value="#{item.leitoID}"/> 
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_ANDAR_ALA_UNIDADE}"/> 
                </f:facet>  
                <h:outputText value="#{item.unidadeFuncional.LPADAndarAlaDescricao}"/> 
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_SITUACAO_LEITO}"/> 
                </f:facet>  
                <h:outputText value="#{item.tipoMovimentoLeito.grupoMvtoLeito.descricao}"/> 
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputText id="situacao" label="#{messages.LABEL_SITUACAO_LEITO}" value="#{liberaLeitoController.leitos.tipoMovimentoLeito.grupoMvtoLeito.descricao}" readonly="true" size="35" styleclass="suggestion_input" style="text-transform:uppercase"/> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:suggestionBox id="suggestionMotivo" required="true" styleClassField="frm_obrigatorio" label="#{messages.LABEL_NOVA_SITUACAO_LIBERA_LEITO}" title="#{messages.TITLE_NOVA_SITUACAO_LIBERA_LEITO}" descricaoInput="codigo" size="10" maxlength="45" disabled="false" descricaoLabel="descricao" suggestionAction="pesquisarMotivos" controller="#{liberaLeitoController}" value="#{liberaLeitoController.tiposMovimentoLeito}" render="justificativa"> 
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_CODIGO}"/> 
                </f:facet>  
                <h:outputText value="#{item.codigo}"/> 
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_DESCRICAO}"/> 
                </f:facet>  
                <h:outputText value="#{item.descricao}"/> 
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputNumero label="#{messages.LABEL_VINCULO}" title="#{messages.TITLE_VINCULO_LIBERA}" maxlength="3" size="3" id="codigoResponsavel" readonly="true" value="#{liberaLeitoController.rapServidores.id.vinCodigo}"/>  
            <mec:suggestionBox id="suggestionResponsavel" required="true" styleClassField="frm_obrigatorio" label="#{messages.LABEL_MATRICULA}" title="#{messages.TITLE_MATRICULA_LIBERA}" descricaoInput="id.matricula" size="10" maxlength="45" disabled="false" descricaoLabel="pessoaFisica.nome" suggestionAction="pesquisarResponsaveis" controller="#{liberaLeitoController}" value="#{liberaLeitoController.rapServidores}" render="nomeUsualResponsavel,codigoResponsavel"> 
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_VINCULO}"/> 
                </f:facet>  
                <h:outputText value="#{item.id.vinCodigo}"/> 
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_MATRICULA}"/> 
                </f:facet>  
                <h:outputText value="#{item.id.matricula}"/> 
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_NOME}"/> 
                </f:facet>  
                <h:outputText value="#{item.pessoaFisica.nome}"/> 
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputText id="nomeUsualResponsavel" label="Nome Usual" value="#{liberaLeitoController.rapServidores.pessoaFisica.nomeUsual}" title="Nome Usual" readonly="true" size="35" styleclass="suggestion_input" style="text-transform:uppercase"/> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputTextData id="dataLancamento" value="#{liberaLeitoController.dataLancamento}" label="#{messages.LABEL_DATA_LANCAMENTO_LIBERA_LEITO}" title="#{messages.TITLE_DATA_LANCAMENTO_LIBERA_LEITO}" size="15" required="true" tipo="datahora"/> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputTextArea label="Justificativa" id="justificativa" style="resize:none" cols="50" maxlength="240" rows="4" value="#{liberaLeitoController.justificativas}" required="#{liberaLeitoController.justificativaObrigatoria}" title="Digite a justificativa para a liberação do leito."/> 
          </aghu:linha> 
        </aghu:panelGeral>  
        <aghu:acao> 
          <mec:commandButton value="Liberar" id="bt_etiq" action="#{liberaLeitoController.validarDados}" render="formPesquisa, openModal" profile="ok" ajax="true"/>  
          <mec:commandButton value="#{messages.LABEL_LIMPAR}" id="bt_limparPesquisa" action="#{liberaLeitoController.limparPesquisa}" ajax="true" render="formPesquisa, openModal" process="@this" styleClass="bt_cinza" profile="clear"/>  
          <mec:commandButton id="bt_cancelar" value="#{messages.LABEL_CANCELAR}" immediate="true" rendered="#{not empty liberaLeitoController.cameFrom}" action="#{liberaLeitoController.cancelar}" profile="cancel"/> 
        </aghu:acao> 
      </h:form>  
      <p:outputPanel id="openModal" layout="inline"> 
        <p:dialog id="modal" showWhenRendered="true" rendered="#{liberaLeitoController.validado}" width="400" height="150" modal="true" resizable="false" widgetVar="modalWG"> 
          <f:facet name="header"> 
            <h:outputText value="Liberar Leito"/> 
          </f:facet> Confirma liberação do leito? 
          <br clear="none"/>  
          <br clear="none"/>  
          <br clear="none"/>  
          <h:panelGroup> 
            <h:form prependId="false" id="formModalLiberar"> 
              <mec:commandButton value="#{messages.LABEL_SIM}" oncomplete="PF('modalWG').hide();" action="#{liberaLeitoController.liberar}" id="bt_excluir" profile="ok" ajax="true" disabled="#{mf:hasPermission(securityController, 'internacao,somenteLeitura')}" render="formPesquisa"/>  
              <mec:commandButton value="#{messages.LABEL_NAO}" oncomplete="PF('modalWG').hide();" action="#{liberaLeitoController.cancelarLiberacao}" profile="cancel" ajax="true"/> 
            </h:form> 
          </h:panelGroup> 
        </p:dialog> 
      </p:outputPanel> 
    </ui:define> 
  </ui:composition> 
</html>
