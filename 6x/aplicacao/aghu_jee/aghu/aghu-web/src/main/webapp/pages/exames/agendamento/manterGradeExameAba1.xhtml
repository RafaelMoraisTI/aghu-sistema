<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions" xmlns:mec="http://xmlns.jcp.org/jsf/composite/components" xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:aghu="http://xmlns.jcp.org/jsf/component" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:mf="http://www.mec.gov.br/taglib">  
  <ui:composition> 
    <p:outputPanel id="aba1_principal" layout="inline"> 
      <p:outputPanel id="aba1_principal_formulario" layout="inline"> 
        <aghu:linha> 
          <mec:inputNumero id="seq" 
          		readonly="true" 
          		label="#{messages.LABEL_SEQ_GRADE_EXAME}" 
          		title="#{messages.TITLE_SEQ_GRADE_EXAME}" 
          		size="6" maxlength="6" 
          		value="#{manterGradeExameController.gradeAgendamentoExame.id.seqp}"/>  
          <mec:suggestionBox id="unidadeExecutora" 
          		label="#{messages.LABEL_UNIDADE_EXECUTORA}" 
          		title="#{messages.TITLE_UNIDADE_EXECUTORA}" 
          		width="500" 
          		suggestionAction="pesquisarUnidadeExecutora" 
          		required="true" 
          		readonly="#{manterGradeExameController.gradeAgendamentoExame.id != null}" 
          		posDeleteAction="limparSuggestions" 
          		descricaoInput="seq" 
          		descricaoLabel="descricao" 
          		controller="#{manterGradeExameController}" 
          		value="#{manterGradeExameController.gradeAgendamentoExame.unidadeFuncional}" 
          		render="exame, grupoExame, sala"> 
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_CODIGO}</b> 
              </f:facet> #{item.seq}
            </p:column>  
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_SIGLA}</b> 
              </f:facet> #{item.sigla}
            </p:column>  
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_ANDAR}</b> 
              </f:facet> #{item.andar}
            </p:column>  
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_DESCRICAO}</b> 
              </f:facet> #{item.descricao}
            </p:column> 
          </mec:suggestionBox>  
          <mec:selectOneMenu id="situacao" 
          		enum="DominioSituacao" 
          		label="#{messages.LABEL_SITUACAO_GRADE_EXAMES}" 
          		required="true" 
          		value="#{manterGradeExameController.gradeAgendamentoExame.situacao}" 
          		title="#{messages.TITLE_SITUACAO_GRADE_EXAME_MANTER}"/> 
        </aghu:linha>  
        <aghu:linha> 
          <mec:suggestionBox id="sala" 
          		label="#{messages.LABEL_IDENTIFICACAO_SALA}" 
          		title="#{messages.TITLE_SALA_GRADE_EXAME_MANTER}" 
          		descricaoInput="id.seqp" 
          		descricaoLabel="numero" 
          		suggestionAction="pesquisarSala"
          		cache="false" 
          		width="360" 
          		controller="#{manterGradeExameController}" 
          		value="#{manterGradeExameController.gradeAgendamentoExame.salaExecutoraExames}"> 
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_CODIGO}</b> 
              </f:facet> #{item.id.seqp}
            </p:column>  
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_IDENTIFICACAO_SALA}</b> 
              </f:facet> #{item.numero}
            </p:column>  
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_LOCALIZACAO_SALA}</b> 
              </f:facet> #{item.localizacao}
            </p:column> 
          </mec:suggestionBox> 
        </aghu:linha>  
        <aghu:linha> 
          <mec:suggestionBox id="grupoExame" 
          		label="#{messages.LABEL_GRUPO_EXAME}" 
          		title="#{messages.TITLE_GRUPO_EXAME_GRADE_MANTER}" 
          		descricaoInput="seq" 
          		descricaoLabel="descricao" 
          		suggestionAction="pesquisarGrupoExame" 
          		controller="#{manterGradeExameController}" 
          		value="#{manterGradeExameController.gradeAgendamentoExame.grupoExame}"> 
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_CODIGO}</b> 
              </f:facet> #{item.seq}
            </p:column>  
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_DESCRICAO}</b> 
              </f:facet> #{item.descricao}
            </p:column> 
          </mec:suggestionBox> 
        </aghu:linha>  
        <aghu:linha> 
          <mec:suggestionBox id="exame" 
          		label="#{messages.LABEL_EXAME}" 
          		required="false" 
          		title="#{messages.TITLE_EXAME_GRUPO_EXAME_MANTER}" 
          		descricaoInput="id.sigla" 
          		size="20" maxlength="30" 
          		width="1200" 
          		descricaoLabel="descricaoExame" 
          		suggestionAction="pesquisarExame" 
          		posDeleteAction="limparExame" 
          		controller="#{manterGradeExameController}" 
          		value="#{manterGradeExameController.viewExame}"> 
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_EXAME}</b> 
              </f:facet>  
              <h:outputText value="#{item.id.sigla}"/> 
            </p:column>  
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_DESCRICAO}</b> 
              </f:facet>  
              <h:outputText value="#{item.descricaoExame}"/> 
            </p:column>  
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_MATERIAL_ANALISE}</b> 
              </f:facet>  
              <h:outputText value="#{item.descricaoMaterial}"/> 
            </p:column>  
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_UNIDADE_EXECUTORA}</b> 
              </f:facet>  
              <h:outputText value="#{item.descricaoUnidade}"/> 
            </p:column> 
          </mec:suggestionBox> 
        </aghu:linha>  
        <aghu:linha> 
          <mec:suggestionBox id="responsavel" 
          		label="#{messages.LABEL_RESPONSAVEL}" 
          		title="#{messages.TITLE_RESPONSAVEL_GRADE_EXAME_MANTER}" 
          		descricaoInput="id.matricula" 
          		width="500" 
          		readonly="#{manterGradeExameController.gradeAgendamentoExame.id != null}" 
          		descricaoLabel="pessoaFisica.nome" 
          		suggestionAction="pesquisarServidor" 
          		controller="#{manterGradeExameController}" 
          		value="#{manterGradeExameController.gradeAgendamentoExame.servidor}"> 
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_MATRICULA}</b> 
              </f:facet> #{item.id.matricula}
            </p:column>  
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_VINCULO}</b> 
              </f:facet> #{item.id.vinCodigo}
            </p:column>  
            <p:column> 
              <f:facet name="header"> 
                <b>#{messages.LABEL_NOME}</b> 
              </f:facet> #{item.pessoaFisica.nome}
            </p:column> 
          </mec:suggestionBox> 
        </aghu:linha> 
      </p:outputPanel>  
      <aghu:acao> 
        <mec:commandButton id="bt_salvar_edicao" 
        		rendered="#{not empty manterGradeExameController.gradeAgendamentoExame.id and mf:hasPermission(securityController,'manterGradeAgendamento,manterGrade')}" 
        		value="#{messages.LABEL_GRAVAR}" 
        		process="@this @(#unidadeExecutora) @(#situacao) @(#sala) @(#grupoExame) @(#exame) @(#responsavel)"  
        		action="#{manterGradeExameController.salvar}" 
        		profile="ok" 
        		ajax="true"/>  
        <mec:commandButton id="bt_salvar_novo" 
        		rendered="#{empty manterGradeExameController.gradeAgendamentoExame.id and mf:hasPermission(securityController,'manterGradeAgendamento,manterGrade')}"
        		process="@this @(#unidadeExecutora) @(#situacao) @(#sala) @(#grupoExame) @(#exame) @(#responsavel)"
        		ajax="true" 
        		value="#{messages.LABEL_GRAVAR}" 
        		action="#{manterGradeExameController.salvar}"
        		render="tabsAgendamentoExames" 
        		profile="ok"/> 
      </aghu:acao> 
    </p:outputPanel>  
    <p:outputPanel layout="block" id="aba2_grade" style="width: 25%;position:absolute;top:75%;right:2%;"> 
      <h:outputText value="#{messages.LABEL_MANTER_GRADE_AGENDAMENTO_DATA_GERACAO}:Â " rendered="#{manterGradeExameController.dataHoraUltimaGrade != null}"/>  
      <h:outputText value="#{manterGradeExameController.dataHoraUltimaGrade}" rendered="#{manterGradeExameController.dataHoraUltimaGrade != null}"> 
        <f:convertDateTime pattern="dd/MM/yyyy"/> 
      </h:outputText>
    </p:outputPanel> 
  </ui:composition> 
</html>
