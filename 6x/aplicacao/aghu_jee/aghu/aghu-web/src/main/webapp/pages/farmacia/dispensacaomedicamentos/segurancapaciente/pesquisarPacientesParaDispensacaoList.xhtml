<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions" xmlns:mec="http://xmlns.jcp.org/jsf/composite/components" xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:aghu="http://xmlns.jcp.org/jsf/component" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:mf="http://www.mec.gov.br/taglib">  
  <ui:composition template="/WEB-INF/templates/form_template.xhtml"> 
    <ui:define name="head"> 
      <title>#{messages['TITLE_PESQUISAR_PACIENTES_DISPENSACAO']} :: #{messages['NOME_ABREVIADO_PROJETO']}</title> 
    </ui:define>  
    <ui:define name="metadata"> 
      <f:metadata> 
        <f:viewAction action="#{pesquisarPacienteDispPaginatorController.iniciarPagina}"/> 
      </f:metadata> 
    </ui:define>  
    <ui:define name="body"> 
      <mec:pageConfig controller="#{pesquisarPacienteDispPaginatorController}"/>  
      <h:form prependId="false" id="formPesquisa"> 
        <aghu:panelGeral legend="#{messages.TITLE_PESQUISAR_PACIENTES_DISPENSACAO}"> 
          <aghu:linha> 
            <mec:inputTextData label="#{messages.LABEL_DATA_REFERENCIA}" title="#{messages.TITLE_PESQ_PAC_DISP_DTA_REFERENCIA}" required="true" value="#{pesquisarPacienteDispPaginatorController.dataReferencia}" id="dtaReferencia" tipo="data"/>  
            <mec:suggestionBox required="true" itemValue="#{farmacia}" var="farmacia" label="#{messages.LABEL_FARMACIA}" title="#{messages.TITLE_PESQ_PAC_DISP_FARMACIA_DISPENSACAO}" descricaoInput="seq" descricaoLabel="andarAlaDescricao" suggestionAction="pesquisarFarmacias" width="400" id="farmacia" controller="#{pesquisarPacienteDispPaginatorController}" value="#{pesquisarPacienteDispPaginatorController.farmacia}"> 
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_CODIGO_UNIDADE}" style="font-weight: bold;"/> 
                </f:facet> #{farmacia.seq}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_ANDAR}" style="font-weight: bold;"/> 
                </f:facet> #{farmacia.andar}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_ALA}" style="font-weight: bold;"/> 
                </f:facet> #{farmacia.indAla}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_DESCRICAO}" style="font-weight: bold;"/> 
                </f:facet> #{farmacia.descricao}
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:suggestionBox label="#{messages.LABEL_UNIDADE_FUNCIONAL}" itemValue="#{unf}" var="unf" title="#{messages.TITLE_PESQ_PAC_DISP_UNIDADE_FUNCIONAL}" descricaoInput="seq" descricaoLabel="andarAlaDescricao" suggestionAction="pesquisarUnidades" width="550" id="unidade" controller="#{pesquisarPacienteDispPaginatorController}" value="#{pesquisarPacienteDispPaginatorController.unidadeFuncionalPrescricao}"> 
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_CODIGO_UNIDADE}" style="font-weight: bold;"/> 
                </f:facet> #{unf.seq}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_ANDAR}" style="font-weight: bold;"/> 
                </f:facet> #{unf.andar}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_ALA}" style="font-weight: bold;"/> 
                </f:facet> #{unf.indAla}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_DESCRICAO}" style="font-weight: bold;"/> 
                </f:facet> #{unf.descricao}
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:suggestionBox label="#{messages.LABEL_LEITO}" title="#{messages.TITLE_PESQ_PAC_DISP_LEITO}" itemValue="#{leito}" var="leito" descricaoInput="leitoID" descricaoLabel="unidadeFuncional.andarAlaDescricao" suggestionAction="pesquisarLeitos" width="500" id="leito" controller="#{pesquisarPacienteDispPaginatorController}" value="#{pesquisarPacienteDispPaginatorController.leito}"> 
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_CODIGO}" style="font-weight: bold;"/> 
                </f:facet> #{leito.leitoID}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_LEITO}" style="font-weight: bold;"/> 
                </f:facet> #{leito.leito}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_ANDAR}" style="font-weight: bold;"/> 
                </f:facet> #{leito.unidadeFuncional.andar}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{LABEL_ALA}" style="font-weight: bold;"/> 
                </f:facet> #{leito.unidadeFuncional.indAla}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_DESCRICAO}" style="font-weight: bold;"/> 
                </f:facet> #{leito.unidadeFuncional.descricao}
              </p:column> 
            </mec:suggestionBox>  
            <mec:suggestionBox label="#{messages.LABEL_QUARTO}" title="#{messages.TITLE_PESQ_PAC_DISP_QUARTO}" itemValue="#{quarto}" var="quarto" maxlength="10" descricaoInput="descricao" descricaoLabel="unidadeFuncional.andarAlaDescricao" suggestionAction="pesquisarQuartos" width="500" id="quarto" controller="#{pesquisarPacienteDispPaginatorController}" value="#{pesquisarPacienteDispPaginatorController.quarto}"> 
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_NUMERO}" style="font-weight: bold;"/> 
                </f:facet> #{quarto.descricao}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_ANDAR}" style="font-weight: bold;"/> 
                </f:facet> #{quarto.unidadeFuncional.andar}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{LABEL_ALA}" style="font-weight: bold;"/> 
                </f:facet> #{quarto.unidadeFuncional.indAla}
              </p:column>  
              <p:column> 
                <f:facet name="header"> 
                  <h:outputText value="#{messages.LABEL_DESCRICAO}" style="font-weight: bold;"/> 
                </f:facet> #{quarto.unidadeFuncional.descricao}
              </p:column> 
            </mec:suggestionBox> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:suggestionBox maxlength="9" styleClass="mask_prontuario" label="#{messages.LABEL_PRONTUARIO}" itemValue="#{paciente}" var="paciente" descricaoInput="prontuario" descricaoLabel="nome" suggestionAction="pesquisarPacientes" title="#{messages.TITLE_LIST_PRONTUARIO_CONTA_HOPS}" ajaxRendered="true" id="paciente" controller="#{pesquisarPacienteDispPaginatorController}" value="#{pesquisarPacienteDispPaginatorController.paciente}"> 
              <p:column>#{paciente.prontuario}</p:column>  
              <p:column>#{paciente.nome}</p:column> 
            </mec:suggestionBox> 
          </aghu:linha> 
        </aghu:panelGeral>  
        <aghu:acao> 
          <mec:commandButton id="bt_pesquisar" value="#{messages.LABEL_PESQUISAR}" block="true" action="#{pesquisarPacienteDispPaginatorController.efetuarPesquisa}" profile="search"/>  
          <mec:commandButton id="bt_limpar" immediate="true" action="#{pesquisarPacienteDispPaginatorController.limpar}" value="#{messages.LABEL_LIMPAR}" ajax="true" render="formPesquisa" process="@this" styleClass="bt_cinza" profile="clear"/>  
          <mec:commandButton value="#{messages.LABEL_LEGENDA_CORES}" immediate="true" onclick="PF('ModalSituacaoDispensacaoWG').show();" type="button" ajax="true" styleClass="bt_cinza"/> 
        </aghu:acao>  
        <mec:serverDataTable id="tabelaPacientes" dataModel="dataModel" controller="#{pesquisarPacienteDispPaginatorController}"> 
          <c:set var="_item" value="#{item}"/>  
          <p:column style="width:6%; background-color:#{_item.corCelula.descricao}"> 
            <f:facet name="header"> 
              <h:outputText value="#{messages.LABEL_ACAO}"/> 
            </f:facet>  
            <p:outputPanel layout="inline"> 
             <p:outputPanel id="triar" layout="inline">
              <mec:commandLink  rendered="#{_item.flagExibeTriarFunction1}" action="#{pesquisarPacienteDispPaginatorController.showTriarFunction1}" styleClass=" silk-medicamentos-triar silk-icon"/>  
              <mec:commandLink  rendered="#{_item.flagExibeTriarFunction2 and (mf:hasPermission(securityController,'habilitarBotoesPesquisaPacienteFarmacia,habilitarBotoes'))}" action="#{pesquisarPacienteDispPaginatorController.goToRealizarTriagemMdto(_item)}" styleClass=" silk-medicamentos-triar silk-icon"/> 
             </p:outputPanel>  
              <p:tooltip for="triar" direction="bottom-right" styleClass="tooltip" layout="block"> 
                <h:outputText value="#{messages.LABEL_TRIAR}"/> 
              </p:tooltip>  
            </p:outputPanel>  
            <p:outputPanel layout="inline"> 
              <mec:commandLink includePageParams="false" rendered="#{!_item.flagExibeDispensar}" disabled="true" styleClass=" silk-medicamentos-dispensar-off silk-icon"/>  
             <p:outputPanel id="dispensar" layout="inline">
              <mec:commandLink includePageParams="false" rendered="#{_item.flagExibeDispensar and pesquisarPacienteDispPaginatorController.userLogadoPossuiMicroComputador and (!mf:hasPermission(securityController, 'farmacia,somenteLeitura'))}" action="#{pesquisarPacienteDispPaginatorController.goToDispensarMedicamento(_item)}" styleClass=" silk-medicamentos-dispensar silk-icon"/>  
              <mec:commandLink rendered="#{_item.flagExibeDispensar and !pesquisarPacienteDispPaginatorController.userLogadoPossuiMicroComputador and (!mf:hasPermission(securityController, 'farmacia,somenteLeitura'))}" action="#{pesquisarPacienteDispPaginatorController.exibeMsgComputadorNaoCadastrado}" styleClass=" silk-medicamentos-dispensar silk-icon"/> 
             </p:outputPanel>
              <p:tooltip for="dispensar" direction="bottom-right" styleClass="tooltip" layout="block"> 
                <h:outputText value="#{messages.LABEL_DISPENSAR}"/> 
              </p:tooltip>  
			</p:outputPanel> 
          </p:column>  
          <p:column style="width:9%; background-color:#{_item.corCelula.descricao}"> 
            <f:facet name="header"> 
              <h:outputText value="#{messages.LABEL_PRONTUARIO}"/> 
            </f:facet>  
            <h:outputText value="#{_item.prontuario}" styleClass="mask_prontuario}"> 
              <f:converter converterId="prontuarioConverter"/> 
            </h:outputText> 
          </p:column>  
          <p:column style="width:43%; background-color:#{_item.corCelula.descricao}"> 
            <f:facet name="header"> 
              <h:outputText id="paciente" value="#{messages.LABEL_PACIENTE}"/> 
            </f:facet>  
            <p:tooltip for="paciente" direction="bottom-right" styleClass="tooltip" layout="block"> 
              <h:outputText value="#{_item.pacCodigo} - #{_item.pacNome}"/> 
            </p:tooltip>  
            <h:outputText value="#{_item.getCodigoNomeTrunc(59)}"/> 
          </p:column>  
          <p:column style="width:16%; background-color:#{_item.corCelula.descricao}"> 
            <f:facet name="header"> 
              <h:outputText id="localizacao" value="#{messages.LABEL_LOCALIZACAO}"/> 
            </f:facet>  
            <p:tooltip for="localizacao" direction="bottom-right" styleClass="tooltip" layout="block"> 
              <h:outputText value="#{_item.localizacaoPaciente}"/> 
            </p:tooltip>  
            <h:outputText value="#{_item.getLocalizacaoPacienteTrunc(26)}"/> 
          </p:column>  
          <p:column style="width:12%; background-color:#{_item.corCelula.descricao}"> 
            <f:facet name="header"> 
              <h:outputText value="#{messages.LABEL_INICIO_PRESCRICAO}"/> 
            </f:facet>  
            <h:outputText value="#{_item.id.dthrInicio}" isDate="true"> 
              <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/> 
            </h:outputText> 
          </p:column>  
          <p:column style="width:12%; background-color:#{_item.corCelula.descricao}"> 
            <f:facet name="header"> 
              <h:outputText value="#{messages.LABEL_FIM_PRESCRICAO}"/> 
            </f:facet>  
            <h:outputText value="#{_item.id.dthrFim}" isDate="true"> 
              <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/> 
            </h:outputText> 
          </p:column> 
        </mec:serverDataTable> 
      </h:form> 
	  <h:form prependId="false" id="formPesquisa1">	
      <p:dialog id="ModalSituacaoDispensacao" height="290" top="100" resizeable="false" moveable="false" width="350" zindex="2300" modal="true" resizable="false" widgetVar="ModalSituacaoDispensacaoWG"> 
        <f:facet name="header"> 
          <h:outputText value="#{messages.LABEL_SITUACAO}"/> 
        </f:facet>  
        <aghu:linha style="width: 330px;"> 
          <mec:serverDataTable style="width: 100px;" tableStyle="width: 100px;" list="#{pesquisarPacienteDispPaginatorController.dominioCoresSituacaoLista}" scrollable="true"> 
            <c:set var="_item" value="#{item}"/>  
            <p:column style="background-color: #{_item.descricao}; width:10px"	>  
            </p:column>  
            <p:column> 
              <h:outputText value="#{_item.legenda}"/> 
            </p:column> 
          </mec:serverDataTable>  
          <br clear="none"/>  
          <aghu:linha/>  
          <mec:commandButton id="closemodalSituacaoDispensacao" value="#{messages.LABEL_FECHAR}" onclick="PF('ModalSituacaoDispensacaoWG').hide();" styleClass="bt_fechar silk-application-form-delete bt_cinza" ajax="true" profile="cancel"/> 
        </aghu:linha> 
      </p:dialog> 
     </h:form> 
    </ui:define> 
  </ui:composition> 
</html>
