<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions" xmlns:mec="http://xmlns.jcp.org/jsf/composite/components" xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:aghu="http://xmlns.jcp.org/jsf/component" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:mf="http://www.mec.gov.br/taglib">  
  <ui:composition template="/WEB-INF/templates/form_template.xhtml"> 
    <ui:define name="head"> 
      <title>Manter Componentes Sangu√≠neos</title> 
    </ui:define>  
    <ui:define name="metadata"> 
      <f:metadata> 
        <f:viewAction action="#{manterComponentesSanguineosController.inicio}"/> 
      </f:metadata> 
    </ui:define>  
    <ui:define name="body"> 
      <mec:pageConfig controller="#{manterComponentesSanguineosController}" ignoreEnter="true"/>  
      <h:form prependId="false" id="manterComponentesSanguineosForm"> 
        <aghu:panelGeral legend="#{messages.TITLE_MANTER_COMPONENTES_SANGUINEOS}"> 
          <aghu:linha> 
            <mec:inputText id="codigo" size="10" label="#{messages.LABEL_CODIGO}" title="#{messages.TITLE_COMPONENTE_SANGUINEO_PESO_FORNECEDOR}" value="#{manterComponentesSanguineosController.componentesSanguineo.codigo}" style="text-transform:uppercase" required="true" maxlength="2" readonly="#{manterComponentesSanguineosController.editando}"/>  
            <mec:inputText id="descricao" size="50" label="#{messages.LABEL_DESCRICAO}" title="#{messages.TITLE_DESCRICAO_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.descricao}" style="text-transform:uppercase" required="true" readonly="#{manterComponentesSanguineosController.editando}" maxlength="45"/>  
            <mec:inputNumero id="diasValidade" size="10" label="#{messages.LABEL_DIAS_VALIDADE}" title="#{messages.TITLE_DIAS_VALIDADE_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.nroDiasValidade}" required="false" maxlength="5"/>  
            <mec:selectOneMenu id="situacaoComponentesSanguineos" enum="DominioSituacao" label="#{messages.LABEL_SITUACAO}" title="#{messages.TITLE_SITUACAO_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.indSituacao}" required="true" noSelectionOption="true"/> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:selectBooleanCheckbox id="irradiado" label="#{messages.LABEL_IRRADIADO}" title="#{messages.TITLE_IRRADIADO_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.indIrradiado}" required="false"/>  
            <mec:selectBooleanCheckbox id="desleuc" label="#{messages.LABEL_DESLEUC}" title="#{messages.TITLE_DESLEUC_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.indFiltrado}" required="false"/>  
            <mec:selectBooleanCheckbox id="lavado" label="#{messages.LABEL_LAVADO}" title="#{messages.TITLE_LAVADO_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.indLavado}" required="false"/>  
            <mec:selectBooleanCheckbox id="aferese" label="#{messages.LABEL_AFERESE}" title="#{messages.TITLE_AFERESE_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.indAferese}" required="false"/>  
            <mec:selectBooleanCheckbox id="amostra" label="#{messages.LABEL_AMOSTRA}" title="#{messages.TITLE_AMOSTRA_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.indAmostra}" required="false"/>  
            <mec:selectBooleanCheckbox id="permitePrescricao" label="#{messages.LABEL_PERMITE_PRESCRICAO}" title="#{messages.TITLE_PERMITE_PRESCRICAO_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.indPermitePrescricao}" required="false"/>  
            <mec:selectBooleanCheckbox id="justificativa" label="#{messages.LABEL_JUSTIFICATICA}" title="#{messages.TITLE_JUSTIFICATIVA_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.indJustificativa}" required="false"/>  
            <mec:selectBooleanCheckbox id="permitePool" label="#{messages.LABEL_PERMITE_POOL}" title="#{messages.TITLE_PERMITE_POOL_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.indPermitePool}" required="false"/>  
            <mec:selectBooleanCheckbox id="impressoEtiquetas" label="#{messages.LABEL_IMPRESSO_ETIQUETAS}" title="#{messages.TITLE_IMPRESSO_ETIQUETAS_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.indEtiquetaDoacao}" required="false"/>  
            <mec:selectBooleanCheckbox id="permiteRefracionamento" label="#{messages.LABEL_PERMITE_REFRACIONAMENTO}" title="#{messages.TITLE_PERMITE_REFRACIONAMENTO_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.indPermiteRefracionamento}" required="false"/> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputNumero id="codigoTransfusao" label="#{messages.LABEL_CODIGO_TRANSFUSAO}" title="#{messages.TITLE_CODIGO_TRANSFUSAO_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.codTransfusao}" required="false" maxlength="2"/>  
            <mec:inputNumero id="codigoCedenciaBanco" label="#{messages.LABEL_CODIGO_CEDENCIA_BANCO}" title="#{messages.TITLE_CODIGO_CEDENCIA_BANCO_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.codCedenciaBanco}" required="false" maxlength="2"/>  
            <mec:inputNumero id="codigoCedenciaIndustria" label="#{messages.LABEL_CODIGO_CEDENCIA_INDUSTRIA}" title="#{messages.TITLE_CODIGO_CEDENCIA_INDUSTRIA__COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.codCedenciaIndustria}" required="false" maxlength="2"/>  
            <mec:inputNumero id="codigoAutoTransfusao" label="#{messages.LABEL_CODIGO_AUTO_TRANSFUSAO_BANCO}" title="#{messages.TITLE_CODIGO_AUTO_TRANSFUSAO_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.codAutotransfusao}" required="false" maxlength="2"/> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputText id="densidade" label="#{messages.LABEL_DENSIDADE}" title="#{messages.TITLE_DENSIDADE_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.densidade}" maxlength="7" converter="#{bigDecimalConverter}" required="false"/>  
            <mec:inputText id="armazenar" label="#{messages.LABEL_ARMAZENAR}" title="#{messages.TITLE_ARMAZENAR_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.armazenarEm}" style="text-transform:uppercase" required="false" maxlength="30" removerCaratersEspeciais="false"/>  
            <mec:inputText id="descricaoEtiqueta" label="#{messages.LABEL_DESCRICAO_ETIQUETA}" title="#{messages.TITLE_DESCRICAO_ETIQUETA_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.descricaoEtiqueta}" style="text-transform:uppercase" required="false" maxlength="15"/>  
            <mec:inputText id="tempo" label="#{messages.LABEL_TEMPO_HEMOTERAPIA}" size="10" maxlength="8" value="#{manterComponentesSanguineosController.componentesSanguineo.tempo}" title="#{messages.TITLE_TEMPO_COMPONENTES_SANGUINEOS}" styleclass="suggestion_input" datePattern="HH:mm:ss" onkeypress="formatar(this , '99:99:99', event)" dateType="time" required="false"/> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputTextArea id="informacoesAdicionais" label="#{messages.LABEL_INFORMACOES_ADICIONAIS}" title="#{messages.TITLE_INFORMACOES_ADICIONAIS_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.informacoes}" style="text-transform:uppercase" required="false" cols="115" size="32000" maxlength="32000"/> 
          </aghu:linha>  
          <aghu:linha> 
            <mec:inputTextArea id="mensSolicAferese" label="#{messages.LABEL_MENS_SOLIC_AFERESE}" title="#{messages.TITLE_MENS_SOLIC_AFERESE_COMPONENTES_SANGUINEOS}" value="#{manterComponentesSanguineosController.componentesSanguineo.mensSolicAferese}" style="text-transform:uppercase" cols="115" size="500" required="false" maxlength="500"/> 
          </aghu:linha>  
          <mec:inputText id="ProcedimentoInterno_id" label="Procedimento Interno" value="#{manterComponentesSanguineosController.phi}" readonly="true" rendered="#{manterComponentesSanguineosController.phi != null}" size="10"/> 
        </aghu:panelGeral>  
        <p:accordionPanel id="procedimentosRelacionados_id" name="procedimentosRelacionados_name" style="margin: 5px !important;" rendered="#{manterComponentesSanguineosController.exibirPainelInferior}" prependId="false"> 
          <p:tab title="#{messages.TOGGLE_PANEL_NOME_PROCEDIMENTO_RELACIONADO}"> 
            <aghu:panelGeral style="margin-left: 1px !important; margin-right: 1px !important;"> 
              <aghu:linha> 
                <p:outputPanel id="panelConvenio" layout="inline"> 
                  <mec:suggestionBox id="suggestionConvenio_id" label="#{messages.LABEL_CONVENIO}" title="#{messages.TITLE_EXC_CONVENIO}" descricaoInput="cphCspCnvCodigo" descricaoLabel="cnvDescricao" suggestionAction="listarConvenios" requiredFake="true" width="300" readonly="#{manterComponentesSanguineosController.editando}" controller="#{manterComponentesSanguineosController}" value="#{manterComponentesSanguineosController.convenio}"> 
                    <p:column> 
                      <f:facet name="header"> 
                        <b>#{messages.LABEL_CODIGO}</b> 
                      </f:facet> #{item.cphCspCnvCodigo}
                    </p:column>  
                    <p:column> 
                      <f:facet name="header"> 
                        <b>#{messages.LABEL_DESCRICAO}</b> 
                      </f:facet> #{item.cnvDescricao}
                    </p:column> 
                  </mec:suggestionBox> 
                </p:outputPanel>  
                <p:outputPanel id="panelProcedSus" layout="inline"> 
                  <mec:suggestionBox id="suggestionProcedimentoSUS_id" label="#{messages.LABEL_PROCED_SUS}" title="#{messages.TITLE_PROCED_SUS}" required="fake" descricaoInput="codTabela" descricaoLabel="seqDescricao" requiredFake="true" suggestionAction="listarItensProcedHospAtivosPorCodTabelaOuDescricaoEPhoSeq" width="500" controller="#{manterComponentesSanguineosController}" value="#{manterComponentesSanguineosController.itemProcedHospSus}"> 
                    <p:column> 
                      <f:facet name="header"> 
                        <b>#{messages.LABEL_SIGLA_COD_SUS}</b> 
                      </f:facet> #{item.codTabela}
                    </p:column>  
                    <p:column> 
                      <f:facet name="header"> 
                        <b>#{messages.LABEL_IPH}</b> 
                      </f:facet> #{item.id.seq}
                    </p:column>  
                    <p:column> 
                      <f:facet name="header"> 
                        <b>#{messages.LABEL_DESCRICAO}</b> 
                      </f:facet> #{item.descricao}
                    </p:column> 
                  </mec:suggestionBox> 
                </p:outputPanel> 
                <aghu:acao> 
	              	<div style="padding: 18px 0px 0px 0px !important;margin-left: 5px"> 
		                <p:outputPanel id="panel_bt_ed_ad" layout="inline"> 
		                  <mec:commandButton id="bt_adicionar" rendered="#{!relacionarPHISSMController.edicao}" value="#{messages.LABEL_ADICIONAR}" action="#{manterComponentesSanguineosController.adicionar}" process="procedSus, convenio" immediate="true" profile="add" styleClass="bt_verde " ajax="true" render="lista, listagem, panelProcedSus, panel_bt_ed_ad, panelLista, panelConvenio"/>  
		                  <mec:commandButton id="bt_alterar" rendered="#{relacionarPHISSMController.edicao}" value="#{messages.LABEL_ALTERAR}" action="#{manterComponentesSanguineosController.adicionar}" process="procedSus, convenio" immediate="true" profile="ok" ajax="true" render="lista, listagem, panelProcedSus, panel_bt_ed_ad, panelLista, panelConvenio"/>  
		                  <mec:commandButton id="bt_cancelar_edicao" rendered="#{relacionarPHISSMController.edicao}" value="#{messages.LABEL_CANCELAR_EDICAO}" immedite="true" status="commonstatus" action="#{manterComponentesSanguineosController.cancelarEdicao}" ajax="true" render="panel_bt_ed_ad, panelLista, panelProcedSus, panelConvenio" process="@this" profile="cancel"/> 
		                </p:outputPanel>
		            </div> 
	            </aghu:acao> 
              </aghu:linha>  
            </aghu:panelGeral>  
            <p:outputPanel id="panelLista" layout="inline"> 
              <p:outputPanel id="listagem" rendered="#{not empty manterComponentesSanguineosController.convGrupoItemProcedList}" layout="inline"> 
                  <mec:serverDataTable id="lista" scrollHeight="130" list="#{manterComponentesSanguineosController.convGrupoItemProcedList}" scrollable="true"> 
                    <c:set var="_item" value="#{item}"/>  
	                <ui:param name="_style" value="#{(_item == manterComponentesSanguineosController.fatConvGrupoItemProcedSelecionado) ? 'background-color:#EEE8AA' : ''}"/>  
                    <p:column width="60" style="#{_style}"> 
                      <f:facet name="header"> 
                        <h:outputText value="#{messages.LABEL_ACAO}"/> 
                      </f:facet>  
                      <mec:commandLink rendered="#{!relacionarPHISSMController.edicao}" title="#{messages.LABEL_EDITAR}" action="#{manterComponentesSanguineosController.editarProcedimentoRelacionado(_item)}" disabled="#{relacionarPHISSMController.edicao}" profile="edit" ajax="true" render="lista, panelConvenio, panel_bt_ed_ad, panelProcedSus, panelLista, listagem" process="@this"/>  
                      <mec:commandLink rendered="#{!relacionarPHISSMController.edicao}" title="#{messages.LABEL_EXCLUIR}" action="#{manterComponentesSanguineosController.excluirProcedimentoRelacionado(_item)}" disabled="#{relacionarPHISSMController.edicao}" profile="delete" ajax="true" render="panelLista" process="@this"/> 
                    </p:column>  
                    <p:column sortBy="#{_item.itemProcedHospitalar.codTabela}" selfSorted="true" sortOrder="ASCENDING" style="#{_style}"> 
                      <f:facet name="header"> 
                        <h:outputText value="#{messages.LABEL_PROCED_SUS}"/> 
                      </f:facet>  
                      <h:outputText value="#{_item.itemProcedHospitalar.codTabela} - #{_item.itemProcedHospitalar.descricao} "/> 
                    </p:column>  
                    <p:column width="180" style="#{_style}"> 
                      <f:facet name="header"> 
                        <h:outputText value="#{messages.LABEL_CONVENIO}"/> 
                      </f:facet>  
                      <h:outputText value="#{_item.convenioSaudePlano.convenioSaude.descricao}"/> 
                    </p:column>  
                    <p:column width="200" sortBy="#{_item.convenioSaudePlano.id.seq}" selfSorted="true" sortOrder="ASCENDING" style="#{_style}"> 
                      <f:facet name="header"> 
                        <h:outputText value="#{messages.LABEL_PLANO}"/> 
                      </f:facet>  
                      <h:outputText value="#{_item.convenioSaudePlano.id.seq} - #{_item.convenioSaudePlano.descricao}"/> 
                    </p:column> 
                  </mec:serverDataTable> 
              </p:outputPanel> 
            </p:outputPanel> 
          </p:tab> 
        </p:accordionPanel>  
        <aghu:linha> 
          <p:outputPanel id="panelBotoes">
	          <mec:commandButton id="bt_gravar" action="#{manterComponentesSanguineosController.gravar}" value="#{messages.LABEL_GRAVAR}" profile="ok" ajax="true" render="codigo,panelBotoes"/>  
	          <mec:commandButton id="bt_validade_amostra" value="#{messages.LABEL_VALIDADE_AMOSTRA}" disabled="#{manterComponentesSanguineosController.componentesSanguineo.codigo == null}" action="#{manterComponentesSanguineosController.validadeAmostra}" styleClass="bt_cinza"> 
	            <f:setPropertyActionListener target="#{manterValidadeAmostraPaginatorController.codComponente}" value="#{manterComponentesSanguineosController.componentesSanguineo.codigo}" for="command"/> 
	          </mec:commandButton>  
	          <mec:commandButton id="bt_visualizar_exames" block="true" value="#{messages.LABEL_VISUALIZAR_EXAMES}" disabled="#{manterComponentesSanguineosController.componentesSanguineo.codigo == null}" action="#{manterComponentesSanguineosController.visualizarExames}" styleClass="bt_cinza"> 
	            <f:setPropertyActionListener target="#{pesquisarExamesDaHemoterapiaController.voltarPara}" value="prescricaomedica-manterComponentesSanguineos" for="command"/>  
	            <f:setPropertyActionListener target="#{pesquisarExamesDaHemoterapiaController.pesquisaComponenteSaguineo}" value="#{manterComponentesSanguineosController.componentesSanguineo.codigo}" for="command"/> 
	          </mec:commandButton>  
	          <mec:commandButton id="bt_justificativas" value="#{messages.LABEL_JUSTIFICATIVAS}" action="#{manterComponentesSanguineosController.justificativas}" disabled="#{manterComponentesSanguineosController.componentesSanguineo.codigo == null}" styleClass="bt_cinza"> 
	            <f:setPropertyActionListener target="#{pesquisarJustificativasUsoHemoterapicoController.codigoComponenteSanguineo}" value="#{manterComponentesSanguineosController.componentesSanguineo.codigo}" for="command"/>  
	            <f:setPropertyActionListener target="#{pesquisarJustificativasUsoHemoterapicoController.origemRequisicao}" value="ORIGEM_COMPONENTE_SANGUINEO" for="command"/> 
	          </mec:commandButton>  
	          <mec:commandButton id="bt_orientacoes" value="#{messages.LABEL_ORIENTACOES}" disabled="#{manterComponentesSanguineosController.componentesSanguineo.codigo == null}" action="#{manterComponentesSanguineosController.orientacoes}" styleClass="bt_cinza"> 
	            <f:setPropertyActionListener target="#{pesquisarOrientacoesPaginatorController.componenteSanguineoCodigo}" value="#{manterComponentesSanguineosController.componentesSanguineo.codigo}" for="command"/> 
	          </mec:commandButton>  
	          <mec:commandButton id="bt_pesos_bolsa" value="#{messages.LABEL_PESOS_BOLSA}" disabled="#{manterComponentesSanguineosController.componentesSanguineo.codigo == null}" action="#{manterComponentesSanguineosController.pesosBolsa}" styleClass="bt_cinza"> 
	            <f:setPropertyActionListener target="#{pesquisarPesoFornecedorController.componenteSanguineoCodigo}" value="#{manterComponentesSanguineosController.componentesSanguineo.codigo}" for="command"/> 
	          </mec:commandButton>  
	          <mec:commandButton id="bt_voltar" value="#{messages.LABEL_VOLTAR}" action="#{manterComponentesSanguineosController.cancelar}" immediate="true" ajax="true" render="mostrarModalCancelar_outer" styleClass="bt_cinza" profile="back"/>
          </p:outputPanel> 
        </aghu:linha>  
        <p:outputPanel id="mostrarModalCancelar_outer" layout="inline"> 
          <p:outputPanel id="mostrarModalCancelar" rendered="#{manterComponentesSanguineosController.chamarCancelar}" layout="inline"> 
            <script type="text/javascript" xml:space="preserve">
						//<![CDATA[
							PF('modalCancelamentoWG').show();;
						//]]> 
					</script> 
          </p:outputPanel> 
        </p:outputPanel> 
      </h:form>  
      <p:dialog id="modalCancelamento" width="400" height="150" modal="true" resizable="false" widgetVar="modalCancelamentoWG"> 
        <f:facet name="header"> 
          <h:panelGroup> 
            <h:outputText value="#{messages.MENSAGEM_PROCEDIMENTOS_NAO_SALVOS_HEADER}"/> 
          </h:panelGroup> 
        </f:facet> #{messages.MENSAGEM_PROCEDIMENTOS_NAO_SALVOS} 
        <br clear="none"/>  
        <br clear="none"/>  
        <br clear="none"/>  
        <h:panelGroup> 
          <h:form prependId="false" id="formModalCancelar" name="formModalCancelar"> 
            <mec:commandButton value="#{messages.LABEL_SIM}" id="bt_confirmar_cancelar" block="true" action="#{manterComponentesSanguineosController.cancelar}" profile="search"/>  
            <mec:commandButton id="btCancelarCancelar" name="btCancelarCancelar" value="#{messages.LABEL_NAO}" block="true" oncomplete="PF('modalCancelamentoWG').hide();" action="#{manterComponentesSanguineosController.alterarValorChamarCancelar}" profile="cancel"/> 
          </h:form> 
        </h:panelGroup> 
      </p:dialog> 
    </ui:define> 
  </ui:composition> 
</html>
